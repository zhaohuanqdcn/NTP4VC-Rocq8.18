theory edit_distance_EditDistance_distanceqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "./edit_distance_MyWord"
begin
consts suffix :: "edit_distance_MyWord.char list \<Rightarrow> int \<Rightarrow> edit_distance_MyWord.char list"
axiomatization where suffix_nil:   "suffix a (int (length a)) = (Nil :: edit_distance_MyWord.char list)"
  for a :: "edit_distance_MyWord.char list"
axiomatization where suffix_cons:   "suffix a i = Cons (a ! nat i) (suffix a (i + (1 :: int)))"
 if "(0 :: int) \<le> i"
 and "i < int (length a)"
  for i :: "int"
  and a :: "edit_distance_MyWord.char list"
definition min_suffix :: "edit_distance_MyWord.char list \<Rightarrow> edit_distance_MyWord.char list \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int \<Rightarrow> _"
  where "min_suffix a1 a2 i j n \<longleftrightarrow> min_dist (suffix a1 i) (suffix a2 j) n" for a1 a2 i j n
theorem distance'vc:
  fixes w1 :: "edit_distance_MyWord.char list"
  fixes w2 :: "edit_distance_MyWord.char list"
  shows "let n1 :: int = int (length w1); n2 :: int = int (length w2); o1 :: int = n2 + (1 :: int) in (0 :: int) \<le> o1 \<and> (\<forall>(t :: int list). (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < o1 \<longrightarrow> t ! nat i = (0 :: int)) \<and> int (length t) = o1 \<longrightarrow> ((0 :: int) \<le> n2 + (1 :: int) \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < (0 :: int) \<longrightarrow> t ! nat j = n2 - j) \<and> (\<forall>(t1 :: int list). length t1 = length t \<longrightarrow> (\<forall>(i :: int). ((0 :: int) \<le> i \<and> i \<le> n2) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < i \<longrightarrow> t1 ! nat j = n2 - j) \<longrightarrow> (let o2 :: int = n2 - i in ((0 :: int) \<le> i \<and> i < int (length t1)) \<and> (length (t1[nat i := o2]) = length t1 \<longrightarrow> nth (t1[nat i := o2]) o nat = (nth t1 o nat)(i := o2) \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < i + (1 :: int) \<longrightarrow> t1[nat i := o2] ! nat j = n2 - j)))) \<and> ((\<forall>(j :: int). (0 :: int) \<le> j \<and> j < n2 + (1 :: int) \<longrightarrow> t1 ! nat j = n2 - j) \<longrightarrow> (let o2 :: int = n1 - (1 :: int) in ((0 :: int) - (1 :: int) \<le> o2 \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (o2 + (1 :: int)) j (t1 ! nat j)) \<and> (\<forall>(t2 :: int list). length t2 = length t1 \<longrightarrow> (\<forall>(i :: int). (i \<le> o2 \<and> (0 :: int) \<le> i) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) j (t2 ! nat j)) \<longrightarrow> ((0 :: int) \<le> n2 \<and> n2 < int (length t2)) \<and> ((0 :: int) \<le> n2 \<and> n2 < int (length t2)) \<and> (let o3 :: int = t2 ! nat n2 + (1 :: int) in ((0 :: int) \<le> n2 \<and> n2 < int (length t2)) \<and> (length (t2[nat n2 := o3]) = length t2 \<longrightarrow> nth (t2[nat n2 := o3]) o nat = (nth t2 o nat)(n2 := o3) \<longrightarrow> (let o4 :: int = n2 - (1 :: int) in ((0 :: int) - (1 :: int) \<le> o4 \<longrightarrow> ((\<forall>(k :: int). o4 < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t2[nat n2 := o3] ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> o4 \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t2[nat n2 := o3] ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (o4 + (1 :: int)) (t2 ! nat n2)) \<and> (\<forall>(oldt :: int) (t3 :: int list). length t3 = length (t2[nat n2 := o3]) \<longrightarrow> (\<forall>(j :: int). (j \<le> o4 \<and> (0 :: int) \<le> j) \<and> (\<forall>(k :: int). j < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t3 ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> j \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t3 ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (j + (1 :: int)) oldt \<longrightarrow> ((0 :: int) \<le> j \<and> j < int (length t3)) \<and> ((0 :: int) \<le> j \<and> j < int (length w2)) \<and> ((0 :: int) \<le> i \<and> i < int (length w1)) \<and> (if w1 ! nat i = w2 ! nat j then ((0 :: int) \<le> j \<and> j < int (length t3)) \<and> (length (t3[nat j := oldt]) = length t3 \<longrightarrow> nth (t3[nat j := oldt]) o nat = (nth t3 o nat)(j := oldt) \<longrightarrow> (\<forall>(k :: int). j - (1 :: int) < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t3[nat j := oldt] ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> j - (1 :: int) \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t3[nat j := oldt] ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (j - (1 :: int) + (1 :: int)) (t3 ! nat j)) else let o5 :: int = j + (1 :: int) in ((0 :: int) \<le> o5 \<and> o5 < int (length t3)) \<and> ((0 :: int) \<le> j \<and> j < int (length t3)) \<and> (let o6 :: int = min (t3 ! nat j) (t3 ! nat o5) + (1 :: int) in ((0 :: int) \<le> j \<and> j < int (length t3)) \<and> (length (t3[nat j := o6]) = length t3 \<longrightarrow> nth (t3[nat j := o6]) o nat = (nth t3 o nat)(j := o6) \<longrightarrow> (\<forall>(k :: int). j - (1 :: int) < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t3[nat j := o6] ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> j - (1 :: int) \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t3[nat j := o6] ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (j - (1 :: int) + (1 :: int)) (t3 ! nat j))))) \<and> ((\<forall>(k :: int). (0 :: int) - (1 :: int) < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t3 ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> (0 :: int) - (1 :: int) \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t3 ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) ((0 :: int) - (1 :: int) + (1 :: int)) oldt \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (i - (1 :: int) + (1 :: int)) j (t3 ! nat j))))) \<and> (o4 < (0 :: int) - (1 :: int) \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (i - (1 :: int) + (1 :: int)) j (t2[nat n2 := o3] ! nat j))))))) \<and> ((\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 ((0 :: int) - (1 :: int) + (1 :: int)) j (t2 ! nat j)) \<longrightarrow> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) < int (length t2)) \<and> min_dist (suffix w1 (0 :: int)) (suffix w2 (0 :: int)) (t2 ! (0 :: nat))))) \<and> (o2 < (0 :: int) - (1 :: int) \<longrightarrow> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) < int (length t1)) \<and> min_dist (suffix w1 (0 :: int)) (suffix w2 (0 :: int)) (t1 ! (0 :: nat))))))) \<and> (n2 + (1 :: int) < (0 :: int) \<longrightarrow> (let o2 :: int = n1 - (1 :: int) in ((0 :: int) - (1 :: int) \<le> o2 \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (o2 + (1 :: int)) j (t ! nat j)) \<and> (\<forall>(t1 :: int list). length t1 = length t \<longrightarrow> (\<forall>(i :: int). (i \<le> o2 \<and> (0 :: int) \<le> i) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) j (t1 ! nat j)) \<longrightarrow> ((0 :: int) \<le> n2 \<and> n2 < int (length t1)) \<and> ((0 :: int) \<le> n2 \<and> n2 < int (length t1)) \<and> (let o3 :: int = t1 ! nat n2 + (1 :: int) in ((0 :: int) \<le> n2 \<and> n2 < int (length t1)) \<and> (length (t1[nat n2 := o3]) = length t1 \<longrightarrow> nth (t1[nat n2 := o3]) o nat = (nth t1 o nat)(n2 := o3) \<longrightarrow> (let o4 :: int = n2 - (1 :: int) in ((0 :: int) - (1 :: int) \<le> o4 \<longrightarrow> ((\<forall>(k :: int). o4 < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t1[nat n2 := o3] ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> o4 \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t1[nat n2 := o3] ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (o4 + (1 :: int)) (t1 ! nat n2)) \<and> (\<forall>(oldt :: int) (t2 :: int list). length t2 = length (t1[nat n2 := o3]) \<longrightarrow> (\<forall>(j :: int). (j \<le> o4 \<and> (0 :: int) \<le> j) \<and> (\<forall>(k :: int). j < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t2 ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> j \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t2 ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (j + (1 :: int)) oldt \<longrightarrow> ((0 :: int) \<le> j \<and> j < int (length t2)) \<and> ((0 :: int) \<le> j \<and> j < int (length w2)) \<and> ((0 :: int) \<le> i \<and> i < int (length w1)) \<and> (if w1 ! nat i = w2 ! nat j then ((0 :: int) \<le> j \<and> j < int (length t2)) \<and> (length (t2[nat j := oldt]) = length t2 \<longrightarrow> nth (t2[nat j := oldt]) o nat = (nth t2 o nat)(j := oldt) \<longrightarrow> (\<forall>(k :: int). j - (1 :: int) < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t2[nat j := oldt] ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> j - (1 :: int) \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t2[nat j := oldt] ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (j - (1 :: int) + (1 :: int)) (t2 ! nat j)) else let o5 :: int = j + (1 :: int) in ((0 :: int) \<le> o5 \<and> o5 < int (length t2)) \<and> ((0 :: int) \<le> j \<and> j < int (length t2)) \<and> (let o6 :: int = min (t2 ! nat j) (t2 ! nat o5) + (1 :: int) in ((0 :: int) \<le> j \<and> j < int (length t2)) \<and> (length (t2[nat j := o6]) = length t2 \<longrightarrow> nth (t2[nat j := o6]) o nat = (nth t2 o nat)(j := o6) \<longrightarrow> (\<forall>(k :: int). j - (1 :: int) < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t2[nat j := o6] ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> j - (1 :: int) \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t2[nat j := o6] ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) (j - (1 :: int) + (1 :: int)) (t2 ! nat j))))) \<and> ((\<forall>(k :: int). (0 :: int) - (1 :: int) < k \<and> k \<le> n2 \<longrightarrow> min_suffix w1 w2 i k (t2 ! nat k)) \<and> (\<forall>(k :: int). (0 :: int) \<le> k \<and> k \<le> (0 :: int) - (1 :: int) \<longrightarrow> min_suffix w1 w2 (i + (1 :: int)) k (t2 ! nat k)) \<and> min_suffix w1 w2 (i + (1 :: int)) ((0 :: int) - (1 :: int) + (1 :: int)) oldt \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (i - (1 :: int) + (1 :: int)) j (t2 ! nat j))))) \<and> (o4 < (0 :: int) - (1 :: int) \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 (i - (1 :: int) + (1 :: int)) j (t1[nat n2 := o3] ! nat j))))))) \<and> ((\<forall>(j :: int). (0 :: int) \<le> j \<and> j \<le> n2 \<longrightarrow> min_suffix w1 w2 ((0 :: int) - (1 :: int) + (1 :: int)) j (t1 ! nat j)) \<longrightarrow> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) < int (length t1)) \<and> min_dist (suffix w1 (0 :: int)) (suffix w2 (0 :: int)) (t1 ! (0 :: nat))))) \<and> (o2 < (0 :: int) - (1 :: int) \<longrightarrow> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) < int (length t)) \<and> min_dist (suffix w1 (0 :: int)) (suffix w2 (0 :: int)) (t ! (0 :: nat))))))"
  sorry
end
