import Why3.Base
import Why3.why3.Ref.Ref
import Why3.int.Sum
import Why3.matrix.Matrix
open Classical
open Lean4Why3
namespace verifythis_2017_maximum_sum_submatrix_Kadane2D_maximum_submatrixqtvc
axiom mixfix_lbrb_closure :  {α : Type} -> [Inhabited α] -> List α -> ℤ -> α
axiom mixfix_lbrb_closure_def {α : Type} [Inhabited α] (y : List α) (y1 : ℤ) : mixfix_lbrb_closure y y1 = y[Int.toNat y1]!
noncomputable def array_sum (a : List ℤ) (l : ℤ) (h : ℤ) := int.Sum.sum (mixfix_lbrb_closure a) l h
noncomputable def col (m : Matrix.matrix ℤ) (j : ℤ) (i : ℤ) := Matrix.elts m i j
axiom col_closure : Matrix.matrix ℤ -> ℤ -> ℤ -> ℤ
axiom fc : Matrix.matrix ℤ -> ℤ -> ℤ -> ℤ -> ℤ
axiom col_closure_def (y : Matrix.matrix ℤ) (y1 : ℤ) (y2 : ℤ) : col_closure y y1 y2 = col y y1 y2
axiom fc'def (m : Matrix.matrix ℤ) (rl : ℤ) (rh : ℤ) (j : ℤ) : fc m rl rh j = int.Sum.sum (col_closure m j) rl rh
noncomputable def matrix_sum (m : Matrix.matrix ℤ) (rl : ℤ) (rh : ℤ) (cl : ℤ) (ch : ℤ) := int.Sum.sum (fc m rl rh) cl ch
theorem maximum_submatrix'vc (m : Matrix.matrix ℤ) : let o1 : ℤ := Matrix.columns m; (0 : ℤ) ≤ o1 ∧ (∀(a : List ℤ), (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i < o1 → a[Int.toNat i]! = (0 : ℤ)) ∧ Int.ofNat (List.length a) = o1 → (let o2 : ℤ := Matrix.rows m - (1 : ℤ); ((0 : ℤ) ≤ o2 + (1 : ℤ) → (((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ Matrix.columns m) ∧ ((0 : ℤ) = matrix_sum m (0 : ℤ) (0 : ℤ) (0 : ℤ) (0 : ℤ) ∧ (0 : ℤ) ≤ matrix_sum m (0 : ℤ) (0 : ℤ) (0 : ℤ) (0 : ℤ)) ∧ (∀(rl' : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl' ∧ rl' < (0 : ℤ) → rl' ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh cl ch ≤ (0 : ℤ)))) ∧ (∀(chi : ℤ) (clo : ℤ) (rhi : ℤ) (rlo : ℤ) (maxsum : ℤ) (a1 : List ℤ), List.length a1 = List.length a → (∀(rl : ℤ), ((0 : ℤ) ≤ rl ∧ rl ≤ o2) ∧ ((0 : ℤ) ≤ rlo ∧ rlo ≤ rhi ∧ rhi ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo ∧ clo ≤ chi ∧ chi ≤ Matrix.columns m) ∧ (maxsum = matrix_sum m rlo rhi clo chi ∧ (0 : ℤ) ≤ matrix_sum m rlo rhi clo chi) ∧ (∀(rl' : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl' ∧ rl' < rl → rl' ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh cl ch ≤ maxsum)) → (let o3 : ℤ := Matrix.columns m; ((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ o3 ∧ (0 : ℤ) + o3 ≤ Int.ofNat (List.length a1)) ∧ (∀(a2 : List ℤ), List.length a2 = List.length a1 → (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i < (0 : ℤ) ∨ (0 : ℤ) + o3 ≤ i ∧ i < Int.ofNat (List.length a2) → a2[Int.toNat i]! = a1[Int.toNat i]!) ∧ (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i < (0 : ℤ) + o3 → a2[Int.toNat i]! = (0 : ℤ)) → (let o4 : ℤ := Matrix.rows m; let o5 : ℤ := rl + (1 : ℤ); (o5 ≤ o4 + (1 : ℤ) → (((0 : ℤ) ≤ rlo ∧ rlo ≤ rhi ∧ rhi ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo ∧ clo ≤ chi ∧ chi ≤ Matrix.columns m) ∧ (maxsum = matrix_sum m rlo rhi clo chi ∧ (0 : ℤ) ≤ matrix_sum m rlo rhi clo chi) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < o5 → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ maxsum)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a2[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (o5 - (1 : ℤ)))) ∧ (∀(chi1 : ℤ) (clo1 : ℤ) (rhi1 : ℤ) (rlo1 : ℤ) (maxsum1 : ℤ) (a3 : List ℤ), List.length a3 = List.length a2 → (∀(rh : ℤ), (o5 ≤ rh ∧ rh ≤ o4) ∧ ((0 : ℤ) ≤ rlo1 ∧ rlo1 ≤ rhi1 ∧ rhi1 ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo1 ∧ clo1 ≤ chi1 ∧ chi1 ≤ Matrix.columns m) ∧ (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 ∧ (0 : ℤ) ≤ matrix_sum m rlo1 rhi1 clo1 chi1) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < rh → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ maxsum1)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a3[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh - (1 : ℤ))) → (let o6 : ℤ := Matrix.columns m - (1 : ℤ); ((0 : ℤ) ≤ o6 + (1 : ℤ) → ((∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < (0 : ℤ) → a3[Int.toNat j]! = int.Sum.sum (col_closure m j) rl rh) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a3[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh - (1 : ℤ)))) ∧ (∀(a4 : List ℤ), List.length a4 = List.length a3 → (∀(c : ℤ), ((0 : ℤ) ≤ c ∧ c ≤ o6) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < c → a4[Int.toNat j]! = int.Sum.sum (col_closure m j) rl rh) ∧ (∀(j : ℤ), c ≤ j ∧ j < Matrix.columns m → a4[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh - (1 : ℤ))) → (let o7 : ℤ := rh - (1 : ℤ); Matrix.valid_index m o7 c ∧ ((0 : ℤ) ≤ c ∧ c < Int.ofNat (List.length a4)) ∧ (let o8 : ℤ := a4[Int.toNat c]! + Matrix.elts m o7 c; ((0 : ℤ) ≤ c ∧ c < Int.ofNat (List.length a4)) ∧ (List.length (List.set a4 (Int.toNat c) o8) = List.length a4 → getElem! (List.set a4 (Int.toNat c) o8) ∘ Int.toNat = Function.update (getElem! a4 ∘ Int.toNat) c o8 → (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < c + (1 : ℤ) → (List.set a4 (Int.toNat c) o8)[Int.toNat j]! = int.Sum.sum (col_closure m j) rl rh) ∧ (∀(j : ℤ), c + (1 : ℤ) ≤ j ∧ j < Matrix.columns m → (List.set a4 (Int.toNat c) o8)[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh - (1 : ℤ))))))) ∧ ((∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < o6 + (1 : ℤ) → a4[Int.toNat j]! = int.Sum.sum (col_closure m j) rl rh) ∧ (∀(j : ℤ), o6 + (1 : ℤ) ≤ j ∧ j < Matrix.columns m → a4[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh - (1 : ℤ))) → (∀(lo : ℤ) (hi : ℤ), ((0 : ℤ) ≤ lo ∧ lo ≤ hi ∧ hi ≤ Int.ofNat (List.length a4)) ∧ (∀(l : ℤ) (h : ℤ), (0 : ℤ) ≤ l ∧ l ≤ h ∧ h ≤ Int.ofNat (List.length a4) → array_sum a4 l h ≤ array_sum a4 lo hi) → (if maxsum1 < array_sum a4 lo hi then ((0 : ℤ) ≤ rl ∧ rl ≤ rh ∧ rh ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ lo ∧ lo ≤ hi ∧ hi ≤ Matrix.columns m) ∧ (array_sum a4 lo hi = matrix_sum m rl rh lo hi ∧ (0 : ℤ) ≤ matrix_sum m rl rh lo hi) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < rh + (1 : ℤ) → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ array_sum a4 lo hi)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a4[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh + (1 : ℤ) - (1 : ℤ))) else ((0 : ℤ) ≤ rlo1 ∧ rlo1 ≤ rhi1 ∧ rhi1 ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo1 ∧ clo1 ≤ chi1 ∧ chi1 ≤ Matrix.columns m) ∧ (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 ∧ (0 : ℤ) ≤ matrix_sum m rlo1 rhi1 clo1 chi1) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < rh + (1 : ℤ) → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ maxsum1)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a4[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh + (1 : ℤ) - (1 : ℤ)))))))) ∧ (o6 + (1 : ℤ) < (0 : ℤ) → (∀(lo : ℤ) (hi : ℤ), ((0 : ℤ) ≤ lo ∧ lo ≤ hi ∧ hi ≤ Int.ofNat (List.length a3)) ∧ (∀(l : ℤ) (h : ℤ), (0 : ℤ) ≤ l ∧ l ≤ h ∧ h ≤ Int.ofNat (List.length a3) → array_sum a3 l h ≤ array_sum a3 lo hi) → (if maxsum1 < array_sum a3 lo hi then ((0 : ℤ) ≤ rl ∧ rl ≤ rh ∧ rh ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ lo ∧ lo ≤ hi ∧ hi ≤ Matrix.columns m) ∧ (array_sum a3 lo hi = matrix_sum m rl rh lo hi ∧ (0 : ℤ) ≤ matrix_sum m rl rh lo hi) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < rh + (1 : ℤ) → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ array_sum a3 lo hi)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a3[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh + (1 : ℤ) - (1 : ℤ))) else ((0 : ℤ) ≤ rlo1 ∧ rlo1 ≤ rhi1 ∧ rhi1 ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo1 ∧ clo1 ≤ chi1 ∧ chi1 ≤ Matrix.columns m) ∧ (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 ∧ (0 : ℤ) ≤ matrix_sum m rlo1 rhi1 clo1 chi1) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < rh + (1 : ℤ) → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ maxsum1)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a3[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (rh + (1 : ℤ) - (1 : ℤ)))))))) ∧ (((0 : ℤ) ≤ rlo1 ∧ rlo1 ≤ rhi1 ∧ rhi1 ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo1 ∧ clo1 ≤ chi1 ∧ chi1 ≤ Matrix.columns m) ∧ (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 ∧ (0 : ℤ) ≤ matrix_sum m rlo1 rhi1 clo1 chi1) ∧ (∀(rl' : ℤ) (rh' : ℤ), (0 : ℤ) ≤ rl' ∧ rl' ≤ rh' ∧ rh' ≤ Matrix.rows m → rl' < rl ∨ rl' = rl ∧ rh' < o4 + (1 : ℤ) → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh' cl ch ≤ maxsum1)) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j < Matrix.columns m → a3[Int.toNat j]! = int.Sum.sum (col_closure m j) rl (o4 + (1 : ℤ) - (1 : ℤ))) → ((0 : ℤ) ≤ rlo1 ∧ rlo1 ≤ rhi1 ∧ rhi1 ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo1 ∧ clo1 ≤ chi1 ∧ chi1 ≤ Matrix.columns m) ∧ (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 ∧ (0 : ℤ) ≤ matrix_sum m rlo1 rhi1 clo1 chi1) ∧ (∀(rl' : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl' ∧ rl' < rl + (1 : ℤ) → rl' ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh cl ch ≤ maxsum1))))) ∧ (o4 + (1 : ℤ) < o5 → ((0 : ℤ) ≤ rlo ∧ rlo ≤ rhi ∧ rhi ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo ∧ clo ≤ chi ∧ chi ≤ Matrix.columns m) ∧ (maxsum = matrix_sum m rlo rhi clo chi ∧ (0 : ℤ) ≤ matrix_sum m rlo rhi clo chi) ∧ (∀(rl' : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl' ∧ rl' < rl + (1 : ℤ) → rl' ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh cl ch ≤ maxsum))))))) ∧ (((0 : ℤ) ≤ rlo ∧ rlo ≤ rhi ∧ rhi ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo ∧ clo ≤ chi ∧ chi ≤ Matrix.columns m) ∧ (maxsum = matrix_sum m rlo rhi clo chi ∧ (0 : ℤ) ≤ matrix_sum m rlo rhi clo chi) ∧ (∀(rl' : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl' ∧ rl' < o2 + (1 : ℤ) → rl' ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl' rh cl ch ≤ maxsum)) → ((0 : ℤ) ≤ rlo ∧ rlo ≤ rhi ∧ rhi ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ clo ∧ clo ≤ chi ∧ chi ≤ Matrix.columns m) ∧ maxsum = matrix_sum m rlo rhi clo chi ∧ (∀(rl : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl ∧ rl ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl rh cl ch ≤ maxsum))))) ∧ (o2 + (1 : ℤ) < (0 : ℤ) → ((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ Matrix.rows m) ∧ ((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ Matrix.columns m) ∧ (0 : ℤ) = matrix_sum m (0 : ℤ) (0 : ℤ) (0 : ℤ) (0 : ℤ) ∧ (∀(rl : ℤ) (rh : ℤ), (0 : ℤ) ≤ rl ∧ rl ≤ rh ∧ rh ≤ Matrix.rows m → (∀(cl : ℤ) (ch : ℤ), (0 : ℤ) ≤ cl ∧ cl ≤ ch ∧ ch ≤ Matrix.columns m → matrix_sum m rl rh cl ch ≤ (0 : ℤ))))))
  := sorry
end verifythis_2017_maximum_sum_submatrix_Kadane2D_maximum_submatrixqtvc
