theory knuth_prime_numbers_PrimeNumbers_prime_numbersqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref"
begin
definition no_prime_in :: "int \<Rightarrow> int \<Rightarrow> _"
  where "no_prime_in l u \<longleftrightarrow> (\<forall>(x :: int). l < x \<and> x < u \<longrightarrow> \<not>prime x)" for l u
definition first_primes :: "(int \<Rightarrow> int) \<Rightarrow> int \<Rightarrow> _"
  where "first_primes p u \<longleftrightarrow> p (0 :: int) = (2 :: int) \<and> (\<forall>(i :: int) (j :: int). (0 :: int) \<le> i \<and> i < j \<and> j < u \<longrightarrow> p i < p j) \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < u \<longrightarrow> prime (p i)) \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < u - (1 :: int) \<longrightarrow> no_prime_in (p i) (p (i + (1 :: int))))" for p u
axiomatization where Bertrand_postulate:   "\<not>no_prime_in p ((2 :: int) * p)"
 if "prime p"
  for p :: "int"
theorem prime_numbers'vc:
  fixes m :: "int"
  assumes fact0: "(2 :: int) \<le> m"
  shows "(0 :: int) \<le> m"
  and "\<forall>(p :: int list). (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < m \<longrightarrow> p ! nat i = (0 :: int)) \<and> int (length p) = m \<longrightarrow> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) < int (length p)) \<and> (length (p[nat (0 :: int) := 2 :: int]) = length p \<longrightarrow> nth (p[nat (0 :: int) := 2 :: int]) o nat = (nth p o nat)(0 :: int := 2 :: int) \<longrightarrow> ((0 :: int) \<le> (1 :: int) \<and> (1 :: int) < int (length (p[nat (0 :: int) := 2 :: int]))) \<and> (length (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int]) = length (p[nat (0 :: int) := 2 :: int]) \<longrightarrow> nth (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int]) o nat = (nth (p[nat (0 :: int) := 2 :: int]) o nat)(1 :: int := 3 :: int) \<longrightarrow> (let o1 :: int = m - (1 :: int) in ((2 :: int) \<le> o1 + (1 :: int) \<longrightarrow> (first_primes (nth (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int]) o nat) (2 :: int) \<and> (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int] ! nat ((2 :: int) - (1 :: int)) < (5 :: int) \<and> (5 :: int) < (2 :: int) * p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int] ! nat ((2 :: int) - (1 :: int))) \<and> odd (5 :: int) \<and> no_prime_in (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int] ! nat ((2 :: int) - (1 :: int))) (5 :: int)) \<and> (\<forall>(n :: int) (p1 :: int list). length p1 = length (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int]) \<longrightarrow> (\<forall>(j :: int). ((2 :: int) \<le> j \<and> j \<le> o1) \<and> first_primes (nth p1 o nat) j \<and> (p1 ! nat (j - (1 :: int)) < n \<and> n < (2 :: int) * p1 ! nat (j - (1 :: int))) \<and> odd n \<and> no_prime_in (p1 ! nat (j - (1 :: int))) n \<longrightarrow> (\<forall>(n1 :: int) (p2 :: int list). length p2 = length p1 \<longrightarrow> (\<forall>(k :: int). ((1 :: int) \<le> k \<and> k < j) \<and> first_primes (nth p2 o nat) j \<and> (p2 ! nat (j - (1 :: int)) < n1 \<and> n1 < (2 :: int) * p2 ! nat (j - (1 :: int))) \<and> odd n1 \<and> no_prime_in (p2 ! nat (j - (1 :: int))) n1 \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < k \<longrightarrow> \<not>p2 ! nat i dvd n1) \<longrightarrow> ((0 :: int) \<le> k \<and> k < int (length p2)) \<and> (let o2 :: int = p2 ! nat k in \<not>o2 = (0 :: int) \<and> (if n1 cmod o2 = (0 :: int) then ((0 :: int) \<le> (2 :: int) * p2 ! nat (j - (1 :: int)) - n1 \<and> (2 :: int) * p2 ! nat (j - (1 :: int)) - (n1 + (2 :: int)) < (2 :: int) * p2 ! nat (j - (1 :: int)) - n1 \<or> (2 :: int) * p2 ! nat (j - (1 :: int)) - n1 = (2 :: int) * p2 ! nat (j - (1 :: int)) - (n1 + (2 :: int)) \<and> (0 :: int) \<le> j - k \<and> j - (1 :: int) < j - k) \<and> ((1 :: int) \<le> (1 :: int) \<and> (1 :: int) < j) \<and> first_primes (nth p2 o nat) j \<and> (p2 ! nat (j - (1 :: int)) < n1 + (2 :: int) \<and> n1 + (2 :: int) < (2 :: int) * p2 ! nat (j - (1 :: int))) \<and> odd (n1 + (2 :: int)) \<and> no_prime_in (p2 ! nat (j - (1 :: int))) (n1 + (2 :: int)) \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < (1 :: int) \<longrightarrow> \<not>p2 ! nat i dvd n1 + (2 :: int)) else ((0 :: int) \<le> k \<and> k < int (length p2)) \<and> ((0 :: int) \<le> k \<and> k < int (length p2)) \<and> (let o3 :: int = p2 ! nat k in \<not>o3 = (0 :: int) \<and> (if p2 ! nat k < n1 cdiv o3 then let o4 :: int = k + (1 :: int) in ((0 :: int) \<le> (2 :: int) * p2 ! nat (j - (1 :: int)) - n1 \<and> (2 :: int) * p2 ! nat (j - (1 :: int)) - n1 < (2 :: int) * p2 ! nat (j - (1 :: int)) - n1 \<or> (0 :: int) \<le> j - k \<and> j - o4 < j - k) \<and> ((1 :: int) \<le> o4 \<and> o4 < j) \<and> first_primes (nth p2 o nat) j \<and> (p2 ! nat (j - (1 :: int)) < n1 \<and> n1 < (2 :: int) * p2 ! nat (j - (1 :: int))) \<and> odd n1 \<and> no_prime_in (p2 ! nat (j - (1 :: int))) n1 \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < o4 \<longrightarrow> \<not>p2 ! nat i dvd n1) else p2 ! nat (j - (1 :: int)) < n1 \<and> prime n1 \<and> no_prime_in (p2 ! nat (j - (1 :: int))) n1)))))) \<and> (((1 :: int) \<le> (1 :: int) \<and> (1 :: int) < j) \<and> first_primes (nth p1 o nat) j \<and> (p1 ! nat (j - (1 :: int)) < n \<and> n < (2 :: int) * p1 ! nat (j - (1 :: int))) \<and> odd n \<and> no_prime_in (p1 ! nat (j - (1 :: int))) n \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < (1 :: int) \<longrightarrow> \<not>p1 ! nat i dvd n)) \<and> (\<forall>(n1 :: int). p1 ! nat (j - (1 :: int)) < n1 \<and> prime n1 \<and> no_prime_in (p1 ! nat (j - (1 :: int))) n1 \<longrightarrow> ((0 :: int) \<le> j \<and> j < int (length p1)) \<and> (length (p1[nat j := n1]) = length p1 \<longrightarrow> nth (p1[nat j := n1]) o nat = (nth p1 o nat)(j := n1) \<longrightarrow> first_primes (nth (p1[nat j := n1]) o nat) (j + (1 :: int)) \<and> (p1[nat j := n1] ! nat (j + (1 :: int) - (1 :: int)) < n1 + (2 :: int) \<and> n1 + (2 :: int) < (2 :: int) * p1[nat j := n1] ! nat (j + (1 :: int) - (1 :: int))) \<and> odd (n1 + (2 :: int)) \<and> no_prime_in (p1[nat j := n1] ! nat (j + (1 :: int) - (1 :: int))) (n1 + (2 :: int))))) \<and> (first_primes (nth p1 o nat) (o1 + (1 :: int)) \<and> (p1 ! nat (o1 + (1 :: int) - (1 :: int)) < n \<and> n < (2 :: int) * p1 ! nat (o1 + (1 :: int) - (1 :: int))) \<and> odd n \<and> no_prime_in (p1 ! nat (o1 + (1 :: int) - (1 :: int))) n \<longrightarrow> int (length p1) = m \<and> first_primes (nth p1 o nat) m))) \<and> (o1 + (1 :: int) < (2 :: int) \<longrightarrow> int (length (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int])) = m \<and> first_primes (nth (p[nat (1 :: int) := 3 :: int, nat (0 :: int) := 2 :: int]) o nat) m))))"
  sorry
end
