theory verifythis_2017_maximum_sum_submatrix_Kadane2D_maximum_submatrixqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "Why3STD.int_Sum" "Why3STD.matrix_Matrix"
begin
consts mixfix_lbrb_closure :: "'a list \<Rightarrow> int \<Rightarrow> 'a"
axiomatization where mixfix_lbrb_closure_def:   "mixfix_lbrb_closure y y1 = y ! nat y1"
  for y :: "'a list"
  and y1 :: "int"
definition array_sum :: "int list \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int"
  where "array_sum a l h = sum (mixfix_lbrb_closure a) l h" for a l h
definition col :: "int matrix \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int"
  where "col m j i = elts m i j" for m j i
consts col_closure :: "int matrix \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int"
consts fc :: "int matrix \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int"
axiomatization where col_closure_def:   "col_closure y y1 y2 = col y y1 y2"
  for y :: "int matrix"
  and y1 :: "int"
  and y2 :: "int"
axiomatization where fc'def:   "fc m rl rh j = sum (col_closure m j) rl rh"
  for m :: "int matrix"
  and rl :: "int"
  and rh :: "int"
  and j :: "int"
definition matrix_sum :: "int matrix \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int \<Rightarrow> int"
  where "matrix_sum m rl rh cl ch = sum (fc m rl rh) cl ch" for m rl rh cl ch
theorem maximum_submatrix'vc:
  fixes m :: "int matrix"
  shows "let o1 :: int = columns m in (0 :: int) \<le> o1 \<and> (\<forall>(a :: int list). (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < o1 \<longrightarrow> a ! nat i = (0 :: int)) \<and> int (length a) = o1 \<longrightarrow> (let o2 :: int = rows m - (1 :: int) in ((0 :: int) \<le> o2 + (1 :: int) \<longrightarrow> (((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> rows m) \<and> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> columns m) \<and> ((0 :: int) = matrix_sum m (0 :: int) (0 :: int) (0 :: int) (0 :: int) \<and> (0 :: int) \<le> matrix_sum m (0 :: int) (0 :: int) (0 :: int) (0 :: int)) \<and> (\<forall>(rl' :: int) (rh :: int). (0 :: int) \<le> rl' \<and> rl' < (0 :: int) \<longrightarrow> rl' \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh cl ch \<le> (0 :: int)))) \<and> (\<forall>(chi :: int) (clo :: int) (rhi :: int) (rlo :: int) (maxsum :: int) (a1 :: int list). length a1 = length a \<longrightarrow> (\<forall>(rl :: int). ((0 :: int) \<le> rl \<and> rl \<le> o2) \<and> ((0 :: int) \<le> rlo \<and> rlo \<le> rhi \<and> rhi \<le> rows m) \<and> ((0 :: int) \<le> clo \<and> clo \<le> chi \<and> chi \<le> columns m) \<and> (maxsum = matrix_sum m rlo rhi clo chi \<and> (0 :: int) \<le> matrix_sum m rlo rhi clo chi) \<and> (\<forall>(rl' :: int) (rh :: int). (0 :: int) \<le> rl' \<and> rl' < rl \<longrightarrow> rl' \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh cl ch \<le> maxsum)) \<longrightarrow> (let o3 :: int = columns m in ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> o3 \<and> (0 :: int) + o3 \<le> int (length a1)) \<and> (\<forall>(a2 :: int list). length a2 = length a1 \<longrightarrow> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < (0 :: int) \<or> (0 :: int) + o3 \<le> i \<and> i < int (length a2) \<longrightarrow> a2 ! nat i = a1 ! nat i) \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < (0 :: int) + o3 \<longrightarrow> a2 ! nat i = (0 :: int)) \<longrightarrow> (let o4 :: int = rows m; o5 :: int = rl + (1 :: int) in (o5 \<le> o4 + (1 :: int) \<longrightarrow> (((0 :: int) \<le> rlo \<and> rlo \<le> rhi \<and> rhi \<le> rows m) \<and> ((0 :: int) \<le> clo \<and> clo \<le> chi \<and> chi \<le> columns m) \<and> (maxsum = matrix_sum m rlo rhi clo chi \<and> (0 :: int) \<le> matrix_sum m rlo rhi clo chi) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < o5 \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> maxsum)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a2 ! nat j = sum (col_closure m j) rl (o5 - (1 :: int)))) \<and> (\<forall>(chi1 :: int) (clo1 :: int) (rhi1 :: int) (rlo1 :: int) (maxsum1 :: int) (a3 :: int list). length a3 = length a2 \<longrightarrow> (\<forall>(rh :: int). (o5 \<le> rh \<and> rh \<le> o4) \<and> ((0 :: int) \<le> rlo1 \<and> rlo1 \<le> rhi1 \<and> rhi1 \<le> rows m) \<and> ((0 :: int) \<le> clo1 \<and> clo1 \<le> chi1 \<and> chi1 \<le> columns m) \<and> (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 \<and> (0 :: int) \<le> matrix_sum m rlo1 rhi1 clo1 chi1) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < rh \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> maxsum1)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a3 ! nat j = sum (col_closure m j) rl (rh - (1 :: int))) \<longrightarrow> (let o6 :: int = columns m - (1 :: int) in ((0 :: int) \<le> o6 + (1 :: int) \<longrightarrow> ((\<forall>(j :: int). (0 :: int) \<le> j \<and> j < (0 :: int) \<longrightarrow> a3 ! nat j = sum (col_closure m j) rl rh) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a3 ! nat j = sum (col_closure m j) rl (rh - (1 :: int)))) \<and> (\<forall>(a4 :: int list). length a4 = length a3 \<longrightarrow> (\<forall>(c :: int). ((0 :: int) \<le> c \<and> c \<le> o6) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < c \<longrightarrow> a4 ! nat j = sum (col_closure m j) rl rh) \<and> (\<forall>(j :: int). c \<le> j \<and> j < columns m \<longrightarrow> a4 ! nat j = sum (col_closure m j) rl (rh - (1 :: int))) \<longrightarrow> (let o7 :: int = rh - (1 :: int) in valid_index m o7 c \<and> ((0 :: int) \<le> c \<and> c < int (length a4)) \<and> (let o8 :: int = a4 ! nat c + elts m o7 c in ((0 :: int) \<le> c \<and> c < int (length a4)) \<and> (length (a4[nat c := o8]) = length a4 \<longrightarrow> nth (a4[nat c := o8]) o nat = (nth a4 o nat)(c := o8) \<longrightarrow> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < c + (1 :: int) \<longrightarrow> a4[nat c := o8] ! nat j = sum (col_closure m j) rl rh) \<and> (\<forall>(j :: int). c + (1 :: int) \<le> j \<and> j < columns m \<longrightarrow> a4[nat c := o8] ! nat j = sum (col_closure m j) rl (rh - (1 :: int))))))) \<and> ((\<forall>(j :: int). (0 :: int) \<le> j \<and> j < o6 + (1 :: int) \<longrightarrow> a4 ! nat j = sum (col_closure m j) rl rh) \<and> (\<forall>(j :: int). o6 + (1 :: int) \<le> j \<and> j < columns m \<longrightarrow> a4 ! nat j = sum (col_closure m j) rl (rh - (1 :: int))) \<longrightarrow> (\<forall>(lo :: int) (hi :: int). ((0 :: int) \<le> lo \<and> lo \<le> hi \<and> hi \<le> int (length a4)) \<and> (\<forall>(l :: int) (h :: int). (0 :: int) \<le> l \<and> l \<le> h \<and> h \<le> int (length a4) \<longrightarrow> array_sum a4 l h \<le> array_sum a4 lo hi) \<longrightarrow> (if maxsum1 < array_sum a4 lo hi then ((0 :: int) \<le> rl \<and> rl \<le> rh \<and> rh \<le> rows m) \<and> ((0 :: int) \<le> lo \<and> lo \<le> hi \<and> hi \<le> columns m) \<and> (array_sum a4 lo hi = matrix_sum m rl rh lo hi \<and> (0 :: int) \<le> matrix_sum m rl rh lo hi) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < rh + (1 :: int) \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> array_sum a4 lo hi)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a4 ! nat j = sum (col_closure m j) rl (rh + (1 :: int) - (1 :: int))) else ((0 :: int) \<le> rlo1 \<and> rlo1 \<le> rhi1 \<and> rhi1 \<le> rows m) \<and> ((0 :: int) \<le> clo1 \<and> clo1 \<le> chi1 \<and> chi1 \<le> columns m) \<and> (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 \<and> (0 :: int) \<le> matrix_sum m rlo1 rhi1 clo1 chi1) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < rh + (1 :: int) \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> maxsum1)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a4 ! nat j = sum (col_closure m j) rl (rh + (1 :: int) - (1 :: int)))))))) \<and> (o6 + (1 :: int) < (0 :: int) \<longrightarrow> (\<forall>(lo :: int) (hi :: int). ((0 :: int) \<le> lo \<and> lo \<le> hi \<and> hi \<le> int (length a3)) \<and> (\<forall>(l :: int) (h :: int). (0 :: int) \<le> l \<and> l \<le> h \<and> h \<le> int (length a3) \<longrightarrow> array_sum a3 l h \<le> array_sum a3 lo hi) \<longrightarrow> (if maxsum1 < array_sum a3 lo hi then ((0 :: int) \<le> rl \<and> rl \<le> rh \<and> rh \<le> rows m) \<and> ((0 :: int) \<le> lo \<and> lo \<le> hi \<and> hi \<le> columns m) \<and> (array_sum a3 lo hi = matrix_sum m rl rh lo hi \<and> (0 :: int) \<le> matrix_sum m rl rh lo hi) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < rh + (1 :: int) \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> array_sum a3 lo hi)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a3 ! nat j = sum (col_closure m j) rl (rh + (1 :: int) - (1 :: int))) else ((0 :: int) \<le> rlo1 \<and> rlo1 \<le> rhi1 \<and> rhi1 \<le> rows m) \<and> ((0 :: int) \<le> clo1 \<and> clo1 \<le> chi1 \<and> chi1 \<le> columns m) \<and> (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 \<and> (0 :: int) \<le> matrix_sum m rlo1 rhi1 clo1 chi1) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < rh + (1 :: int) \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> maxsum1)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a3 ! nat j = sum (col_closure m j) rl (rh + (1 :: int) - (1 :: int)))))))) \<and> (((0 :: int) \<le> rlo1 \<and> rlo1 \<le> rhi1 \<and> rhi1 \<le> rows m) \<and> ((0 :: int) \<le> clo1 \<and> clo1 \<le> chi1 \<and> chi1 \<le> columns m) \<and> (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 \<and> (0 :: int) \<le> matrix_sum m rlo1 rhi1 clo1 chi1) \<and> (\<forall>(rl' :: int) (rh' :: int). (0 :: int) \<le> rl' \<and> rl' \<le> rh' \<and> rh' \<le> rows m \<longrightarrow> rl' < rl \<or> rl' = rl \<and> rh' < o4 + (1 :: int) \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh' cl ch \<le> maxsum1)) \<and> (\<forall>(j :: int). (0 :: int) \<le> j \<and> j < columns m \<longrightarrow> a3 ! nat j = sum (col_closure m j) rl (o4 + (1 :: int) - (1 :: int))) \<longrightarrow> ((0 :: int) \<le> rlo1 \<and> rlo1 \<le> rhi1 \<and> rhi1 \<le> rows m) \<and> ((0 :: int) \<le> clo1 \<and> clo1 \<le> chi1 \<and> chi1 \<le> columns m) \<and> (maxsum1 = matrix_sum m rlo1 rhi1 clo1 chi1 \<and> (0 :: int) \<le> matrix_sum m rlo1 rhi1 clo1 chi1) \<and> (\<forall>(rl' :: int) (rh :: int). (0 :: int) \<le> rl' \<and> rl' < rl + (1 :: int) \<longrightarrow> rl' \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh cl ch \<le> maxsum1))))) \<and> (o4 + (1 :: int) < o5 \<longrightarrow> ((0 :: int) \<le> rlo \<and> rlo \<le> rhi \<and> rhi \<le> rows m) \<and> ((0 :: int) \<le> clo \<and> clo \<le> chi \<and> chi \<le> columns m) \<and> (maxsum = matrix_sum m rlo rhi clo chi \<and> (0 :: int) \<le> matrix_sum m rlo rhi clo chi) \<and> (\<forall>(rl' :: int) (rh :: int). (0 :: int) \<le> rl' \<and> rl' < rl + (1 :: int) \<longrightarrow> rl' \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh cl ch \<le> maxsum))))))) \<and> (((0 :: int) \<le> rlo \<and> rlo \<le> rhi \<and> rhi \<le> rows m) \<and> ((0 :: int) \<le> clo \<and> clo \<le> chi \<and> chi \<le> columns m) \<and> (maxsum = matrix_sum m rlo rhi clo chi \<and> (0 :: int) \<le> matrix_sum m rlo rhi clo chi) \<and> (\<forall>(rl' :: int) (rh :: int). (0 :: int) \<le> rl' \<and> rl' < o2 + (1 :: int) \<longrightarrow> rl' \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl' rh cl ch \<le> maxsum)) \<longrightarrow> ((0 :: int) \<le> rlo \<and> rlo \<le> rhi \<and> rhi \<le> rows m) \<and> ((0 :: int) \<le> clo \<and> clo \<le> chi \<and> chi \<le> columns m) \<and> maxsum = matrix_sum m rlo rhi clo chi \<and> (\<forall>(rl :: int) (rh :: int). (0 :: int) \<le> rl \<and> rl \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl rh cl ch \<le> maxsum))))) \<and> (o2 + (1 :: int) < (0 :: int) \<longrightarrow> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> rows m) \<and> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> columns m) \<and> (0 :: int) = matrix_sum m (0 :: int) (0 :: int) (0 :: int) (0 :: int) \<and> (\<forall>(rl :: int) (rh :: int). (0 :: int) \<le> rl \<and> rl \<le> rh \<and> rh \<le> rows m \<longrightarrow> (\<forall>(cl :: int) (ch :: int). (0 :: int) \<le> cl \<and> cl \<le> ch \<and> ch \<le> columns m \<longrightarrow> matrix_sum m rl rh cl ch \<le> (0 :: int))))))"
  sorry
end
