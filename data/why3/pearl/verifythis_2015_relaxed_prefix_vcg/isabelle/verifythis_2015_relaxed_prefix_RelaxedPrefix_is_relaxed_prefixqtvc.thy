theory verifythis_2015_relaxed_prefix_RelaxedPrefix_is_relaxed_prefixqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref"
begin
typedecl  char
definition eq_array :: "char list \<Rightarrow> int \<Rightarrow> char list \<Rightarrow> int \<Rightarrow> int \<Rightarrow> _"
  where "eq_array a1 ofs1 a2 ofs2 len \<longleftrightarrow> (0 :: int) \<le> len \<and> (0 :: int) \<le> ofs1 \<and> (0 :: int) \<le> ofs2 \<and> ofs1 + len \<le> int (length a1) \<and> ofs2 + len \<le> int (length a2) \<and> (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < len \<longrightarrow> a1 ! nat (ofs1 + i) = a2 ! nat (ofs2 + i))" for a1 ofs1 a2 ofs2 len
definition is_relaxed_prefix :: "char list \<Rightarrow> char list \<Rightarrow> _"
  where "is_relaxed_prefix pat a \<longleftrightarrow> (let n :: int = int (length pat) in eq_array pat (0 :: int) a (0 :: int) n \<or> (\<exists>(i :: int). ((0 :: int) \<le> i \<and> i < n) \<and> eq_array pat (0 :: int) a (0 :: int) i \<and> eq_array pat (i + (1 :: int)) a i (n - i - (1 :: int))))" for pat a
theorem is_relaxed_prefix'vc:
  fixes a :: "char list"
  fixes pat :: "char list"
  shows "let m :: int = int (length a); o1 :: int = int (length pat) - (1 :: int) in ((0 :: int) \<le> o1 + (1 :: int) \<longrightarrow> (((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (1 :: int)) \<and> ((0 :: int) = (1 :: int) \<longrightarrow> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) < (0 :: int)) \<and> (0 :: int) \<le> m + (0 :: int) \<and> eq_array pat (0 :: int) a (0 :: int) (0 :: int)) \<and> (\<forall>(ignored :: int) (shift :: int). (\<forall>(i :: int). ((0 :: int) \<le> i \<and> i \<le> o1) \<and> ((0 :: int) \<le> shift \<and> shift \<le> (1 :: int)) \<and> (shift = (1 :: int) \<longrightarrow> (0 :: int) \<le> ignored \<and> ignored < i) \<and> i \<le> m + shift \<and> (if shift = (0 :: int) then eq_array pat (0 :: int) a (0 :: int) i else eq_array pat (0 :: int) a (0 :: int) ignored \<and> eq_array pat (ignored + (1 :: int)) a ignored (i - ignored - (1 :: int)) \<and> \<not>eq_array pat (0 :: int) a (0 :: int) i \<and> (ignored < m \<longrightarrow> \<not>pat ! nat ignored = a ! nat ignored)) \<longrightarrow> (let o2 :: int = i - shift in (\<not>m \<le> o2 \<longrightarrow> (let o3 :: int = i - shift in ((0 :: int) \<le> o3 \<and> o3 < int (length a)) \<and> (0 :: int) \<le> i \<and> i < int (length pat))) \<and> (\<forall>(o3 :: bool). (if m \<le> o2 then o3 = True else o3 = (if pat ! nat i = a ! nat (i - shift) then False else True)) \<longrightarrow> (if o3 = True then if shift = (1 :: int) then \<not>is_relaxed_prefix pat a else ((0 :: int) \<le> (1 :: int) \<and> (1 :: int) \<le> (1 :: int)) \<and> ((0 :: int) \<le> i \<and> i < i + (1 :: int)) \<and> i + (1 :: int) \<le> m + (1 :: int) \<and> (if (1 :: int) = (0 :: int) then eq_array pat (0 :: int) a (0 :: int) (i + (1 :: int)) else eq_array pat (0 :: int) a (0 :: int) i \<and> eq_array pat (i + (1 :: int)) a i (i + (1 :: int) - i - (1 :: int)) \<and> \<not>eq_array pat (0 :: int) a (0 :: int) (i + (1 :: int)) \<and> (i < m \<longrightarrow> \<not>pat ! nat i = a ! nat i)) else ((0 :: int) \<le> shift \<and> shift \<le> (1 :: int)) \<and> (shift = (1 :: int) \<longrightarrow> (0 :: int) \<le> ignored \<and> ignored < i + (1 :: int)) \<and> i + (1 :: int) \<le> m + shift \<and> (if shift = (0 :: int) then eq_array pat (0 :: int) a (0 :: int) (i + (1 :: int)) else eq_array pat (0 :: int) a (0 :: int) ignored \<and> eq_array pat (ignored + (1 :: int)) a ignored (i + (1 :: int) - ignored - (1 :: int)) \<and> \<not>eq_array pat (0 :: int) a (0 :: int) (i + (1 :: int)) \<and> (ignored < m \<longrightarrow> \<not>pat ! nat ignored = a ! nat ignored)))))) \<and> (((0 :: int) \<le> shift \<and> shift \<le> (1 :: int)) \<and> (shift = (1 :: int) \<longrightarrow> (0 :: int) \<le> ignored \<and> ignored < o1 + (1 :: int)) \<and> o1 + (1 :: int) \<le> m + shift \<and> (if shift = (0 :: int) then eq_array pat (0 :: int) a (0 :: int) (o1 + (1 :: int)) else eq_array pat (0 :: int) a (0 :: int) ignored \<and> eq_array pat (ignored + (1 :: int)) a ignored (o1 + (1 :: int) - ignored - (1 :: int)) \<and> \<not>eq_array pat (0 :: int) a (0 :: int) (o1 + (1 :: int)) \<and> (ignored < m \<longrightarrow> \<not>pat ! nat ignored = a ! nat ignored)) \<longrightarrow> is_relaxed_prefix pat a))) \<and> (o1 + (1 :: int) < (0 :: int) \<longrightarrow> is_relaxed_prefix pat a)"
  sorry
end
