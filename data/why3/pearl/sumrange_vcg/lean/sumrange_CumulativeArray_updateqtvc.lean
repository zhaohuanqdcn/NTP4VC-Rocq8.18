import Why3.Base
import pearl.sumrange_vcg.lean.sumrange.ArraySum
import pearl.sumrange_vcg.lean.sumrange.ExtraLemmas
open Classical
open Lean4Why3
namespace sumrange_CumulativeArray_updateqtvc
noncomputable def is_cumulative_array_for (c : List ℤ) (a : List ℤ) := Int.ofNat (List.length c) = Int.ofNat (List.length a) + (1 : ℤ) ∧ (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i < Int.ofNat (List.length c) → getElem! c (Int.toNat i) = ArraySum.sum a (0 : ℤ) i)
theorem update'vc (c : List ℤ) (a : List ℤ) (i : ℤ) (v : ℤ) (fact0 : is_cumulative_array_for c a) (fact1 : (0 : ℤ) ≤ i) (fact2 : i < Int.ofNat (List.length a)) : (0 : ℤ) ≤ i ∧ i < Int.ofNat (List.length c) ∧ (let o1 : ℤ := i + (1 : ℤ); ((0 : ℤ) ≤ o1 ∧ o1 < Int.ofNat (List.length c)) ∧ (let incr : ℤ := v - getElem! c (Int.toNat o1) + getElem! c (Int.toNat i); ((0 : ℤ) ≤ i ∧ i < Int.ofNat (List.length a)) ∧ (List.length (List.set a (Int.toNat i) v) = List.length a → getElem! (List.set a (Int.toNat i) v) ∘ Int.toNat = Function.update (getElem! a ∘ Int.toNat) i v → (let o2 : ℤ := Int.ofNat (List.length c) - (1 : ℤ); let o3 : ℤ := i + (1 : ℤ); (o3 ≤ o2 + (1 : ℤ) → ((∀(k : ℤ), o3 ≤ k ∧ k < Int.ofNat (List.length c) → getElem! c (Int.toNat k) = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k - incr) ∧ (∀(k : ℤ), (0 : ℤ) ≤ k ∧ k < o3 → getElem! c (Int.toNat k) = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k)) ∧ (∀(c1 : List ℤ), List.length c1 = List.length c → (∀(j : ℤ), (o3 ≤ j ∧ j ≤ o2) ∧ (∀(k : ℤ), j ≤ k ∧ k < Int.ofNat (List.length c1) → c1[Int.toNat k]! = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k - incr) ∧ (∀(k : ℤ), (0 : ℤ) ≤ k ∧ k < j → c1[Int.toNat k]! = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k) → ((0 : ℤ) ≤ j ∧ j < Int.ofNat (List.length c1)) ∧ (let o4 : ℤ := c1[Int.toNat j]! + incr; ((0 : ℤ) ≤ j ∧ j < Int.ofNat (List.length c1)) ∧ (List.length (List.set c1 (Int.toNat j) o4) = List.length c1 → getElem! (List.set c1 (Int.toNat j) o4) ∘ Int.toNat = Function.update (getElem! c1 ∘ Int.toNat) j o4 → (∀(k : ℤ), j + (1 : ℤ) ≤ k ∧ k < Int.ofNat (List.length (List.set c1 (Int.toNat j) o4)) → (List.set c1 (Int.toNat j) o4)[Int.toNat k]! = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k - incr) ∧ (∀(k : ℤ), (0 : ℤ) ≤ k ∧ k < j + (1 : ℤ) → (List.set c1 (Int.toNat j) o4)[Int.toNat k]! = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k)))) ∧ ((∀(k : ℤ), o2 + (1 : ℤ) ≤ k ∧ k < Int.ofNat (List.length c1) → c1[Int.toNat k]! = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k - incr) ∧ (∀(k : ℤ), (0 : ℤ) ≤ k ∧ k < o2 + (1 : ℤ) → c1[Int.toNat k]! = ArraySum.sum (List.set a (Int.toNat i) v) (0 : ℤ) k) → is_cumulative_array_for c1 (List.set a (Int.toNat i) v) ∧ (List.set a (Int.toNat i) v)[Int.toNat i]! = v ∧ (∀(k : ℤ), ((0 : ℤ) ≤ k ∧ k < Int.ofNat (List.length (List.set a (Int.toNat i) v))) ∧ ¬k = i → (List.set a (Int.toNat i) v)[Int.toNat k]! = a[Int.toNat k]!)))) ∧ (o2 + (1 : ℤ) < o3 → is_cumulative_array_for c (List.set a (Int.toNat i) v) ∧ (List.set a (Int.toNat i) v)[Int.toNat i]! = v ∧ (∀(k : ℤ), ((0 : ℤ) ≤ k ∧ k < Int.ofNat (List.length (List.set a (Int.toNat i) v))) ∧ ¬k = i → (List.set a (Int.toNat i) v)[Int.toNat k]! = a[Int.toNat k]!))))))
  := sorry
end sumrange_CumulativeArray_updateqtvc
