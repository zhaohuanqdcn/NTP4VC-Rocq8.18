import Why3.Base
import Why3.why3.Ref.Ref
import Why3.int.Sum
open Classical
open Lean4Why3
namespace hillel_challenge_FulcrumNoOverflow_fulcrumqtvc
axiom big : Type
axiom inhabited_axiom_big : Inhabited big
attribute [instance] inhabited_axiom_big
axiom q : big -> BitVec 32
axiom r : big -> BitVec 32
axiom v : big -> ℤ
axiom big'invariant (self : big) : -((2147483647 : ℤ) + (1 : ℤ)) ≤ BitVec.toInt (q self) ∧ BitVec.toInt (q self) ≤ (2147483647 : ℤ) + (1 : ℤ) - (1 : ℤ) ∧ (0 : ℤ) ≤ BitVec.toInt (r self) ∧ BitVec.toInt (r self) ≤ (2147483647 : ℤ) + (1 : ℤ) - (1 : ℤ) ∧ v self = BitVec.toInt (q self) * ((2147483647 : ℤ) + (1 : ℤ)) + BitVec.toInt (r self)
noncomputable def big'eq (a : big) (b : big) := q a = q b ∧ r a = r b ∧ v a = v b
axiom big'inj (a : big) (b : big) (fact0 : big'eq a b) : a = b
axiom big_zero : Unit -> big
axiom big_zero'def (x : Unit) : q (big_zero x) = (0 : BitVec 32) ∧ r (big_zero x) = (0 : BitVec 32) ∧ v (big_zero x) = (0 : ℤ)
axiom fc : array32 (BitVec 32) -> ℤ -> ℤ
axiom fc'def (a : array32 (BitVec 32)) (i : ℤ) : fc a i = BitVec.toInt (array32_elts a i)
noncomputable def sum (a : array32 (BitVec 32)) (l : ℤ) (u : ℤ) := int.Sum.sum (fc a) l u
noncomputable def diff (a : array32 (BitVec 32)) (i : ℤ) := abs (sum a (0 : ℤ) i - sum a i (BitVec.toInt (array32_length a)))
theorem fulcrum'vc (a : array32 (BitVec 32)) (fact0 : BitVec.toInt (array32_length a) < BitVec.toInt (2147483647 : BitVec 32)) : let n : BitVec 32 := array32_length a; let right1 : big := big_zero (); int'32_in_bounds (BitVec.toInt n - (1 : ℤ)) ∧ (∀(o1 : BitVec 32), BitVec.toInt o1 = BitVec.toInt n - (1 : ℤ) → ((0 : ℤ) ≤ BitVec.toInt o1 + (1 : ℤ) → ((55 : ℤ) < (89 : ℤ) ∧ v right1 = sum a (0 : ℤ) (0 : ℤ)) ∧ (∀(right2 : big), (∀(i : BitVec 32), let i1 : ℤ := BitVec.toInt i; ((0 : ℤ) ≤ i1 ∧ i1 ≤ BitVec.toInt o1) ∧ (55 : ℤ) < (89 : ℤ) ∧ v right2 = sum a (0 : ℤ) i1 → ((0 : ℤ) ≤ BitVec.toInt i ∧ BitVec.toInt i < BitVec.toInt (array32_length a)) ∧ (let o2 : BitVec 32 := array32_elts a (BitVec.toInt i); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ v right2 + BitVec.toInt o2 ∧ v right2 + BitVec.toInt o2 ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(right3 : big), v right3 = v right2 + BitVec.toInt o2 → (55 : ℤ) < (89 : ℤ) ∧ v right3 = sum a (0 : ℤ) (i1 + (1 : ℤ))))) ∧ ((55 : ℤ) < (89 : ℤ) ∧ v right2 = sum a (0 : ℤ) (BitVec.toInt o1 + (1 : ℤ)) → (let left1 : big := big_zero (); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ abs (v left1 - v right2) ∧ abs (v left1 - v right2) ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(bestd : big), v bestd = abs (v left1 - v right2) → int'32_in_bounds (BitVec.toInt n - (1 : ℤ)) ∧ (∀(o2 : BitVec 32), BitVec.toInt o2 = BitVec.toInt n - (1 : ℤ) → ((0 : ℤ) ≤ BitVec.toInt o2 + (1 : ℤ) → ((55 : ℤ) < (89 : ℤ) ∧ v left1 = sum a (0 : ℤ) (0 : ℤ) ∧ v right2 = sum a (0 : ℤ) (BitVec.toInt n) ∧ (0 : ℤ) ≤ (0 : ℤ) ∧ v bestd = diff a (0 : ℤ) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ (0 : ℤ) → v bestd ≤ diff a j)) ∧ (∀(bestd1 : big) (besti : BitVec 32) (left2 : big) (right3 : big), (∀(i : BitVec 32), let i1 : ℤ := BitVec.toInt i; ((0 : ℤ) ≤ i1 ∧ i1 ≤ BitVec.toInt o2) ∧ (55 : ℤ) < (89 : ℤ) ∧ v left2 = sum a (0 : ℤ) i1 ∧ v right3 = sum a i1 (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ i1) ∧ v bestd1 = diff a (BitVec.toInt besti) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ i1 → v bestd1 ≤ diff a j) → ((0 : ℤ) ≤ BitVec.toInt i ∧ BitVec.toInt i < BitVec.toInt (array32_length a)) ∧ (let o3 : BitVec 32 := array32_elts a (BitVec.toInt i); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ v left2 + BitVec.toInt o3 ∧ v left2 + BitVec.toInt o3 ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(left3 : big), v left3 = v left2 + BitVec.toInt o3 → ((0 : ℤ) ≤ BitVec.toInt i ∧ BitVec.toInt i < BitVec.toInt (array32_length a)) ∧ (let o4 : BitVec 32 := array32_elts a (BitVec.toInt i); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ v right3 - BitVec.toInt o4 ∧ v right3 - BitVec.toInt o4 ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(right4 : big), v right4 = v right3 - BitVec.toInt o4 → (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ abs (v left3 - v right4) ∧ abs (v left3 - v right4) ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(d : big), v d = abs (v left3 - v right4) → ((0 : ℤ) ≤ v d ∧ (0 : ℤ) ≤ v bestd1) ∧ (if v d < v bestd1 then ∀(bestd2 : big), int'32_in_bounds (BitVec.toInt i + (1 : ℤ)) ∧ (∀(o5 : BitVec 32), BitVec.toInt o5 = BitVec.toInt i + (1 : ℤ) → ((-((2147483647 : ℤ) + (1 : ℤ)) ≤ BitVec.toInt (q d) ∧ BitVec.toInt (q d) ≤ (2147483647 : ℤ) + (1 : ℤ) - (1 : ℤ)) ∧ ((0 : ℤ) ≤ BitVec.toInt (r d) ∧ BitVec.toInt (r d) ≤ (2147483647 : ℤ) + (1 : ℤ) - (1 : ℤ)) ∧ v d = BitVec.toInt (q d) * ((2147483647 : ℤ) + (1 : ℤ)) + BitVec.toInt (r d)) ∧ (v d = v bestd2 ∧ r d = r bestd2 ∧ q d = q bestd2 → (55 : ℤ) < (89 : ℤ) ∧ v left3 = sum a (0 : ℤ) (i1 + (1 : ℤ)) ∧ v right4 = sum a (i1 + (1 : ℤ)) (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt o5 ∧ BitVec.toInt o5 ≤ i1 + (1 : ℤ)) ∧ v bestd2 = diff a (BitVec.toInt o5) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ i1 + (1 : ℤ) → v bestd2 ≤ diff a j))) else (55 : ℤ) < (89 : ℤ) ∧ v left3 = sum a (0 : ℤ) (i1 + (1 : ℤ)) ∧ v right4 = sum a (i1 + (1 : ℤ)) (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ i1 + (1 : ℤ)) ∧ v bestd1 = diff a (BitVec.toInt besti) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ i1 + (1 : ℤ) → v bestd1 ≤ diff a j)))))))) ∧ ((55 : ℤ) < (89 : ℤ) ∧ v left2 = sum a (0 : ℤ) (BitVec.toInt o2 + (1 : ℤ)) ∧ v right3 = sum a (BitVec.toInt o2 + (1 : ℤ)) (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ BitVec.toInt o2 + (1 : ℤ)) ∧ v bestd1 = diff a (BitVec.toInt besti) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ BitVec.toInt o2 + (1 : ℤ) → v bestd1 ≤ diff a j) → ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ BitVec.toInt (array32_length a)) ∧ (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i ≤ BitVec.toInt (array32_length a) → diff a (BitVec.toInt besti) ≤ diff a i)))) ∧ (BitVec.toInt o2 + (1 : ℤ) < (0 : ℤ) → ((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ BitVec.toInt (array32_length a)) ∧ (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i ≤ BitVec.toInt (array32_length a) → diff a (0 : ℤ) ≤ diff a i)))))))) ∧ (BitVec.toInt o1 + (1 : ℤ) < (0 : ℤ) → (let left1 : big := big_zero (); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ abs (v left1 - v right1) ∧ abs (v left1 - v right1) ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(bestd : big), v bestd = abs (v left1 - v right1) → int'32_in_bounds (BitVec.toInt n - (1 : ℤ)) ∧ (∀(o2 : BitVec 32), BitVec.toInt o2 = BitVec.toInt n - (1 : ℤ) → ((0 : ℤ) ≤ BitVec.toInt o2 + (1 : ℤ) → ((55 : ℤ) < (89 : ℤ) ∧ v left1 = sum a (0 : ℤ) (0 : ℤ) ∧ v right1 = sum a (0 : ℤ) (BitVec.toInt n) ∧ (0 : ℤ) ≤ (0 : ℤ) ∧ v bestd = diff a (0 : ℤ) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ (0 : ℤ) → v bestd ≤ diff a j)) ∧ (∀(bestd1 : big) (besti : BitVec 32) (left2 : big) (right2 : big), (∀(i : BitVec 32), let i1 : ℤ := BitVec.toInt i; ((0 : ℤ) ≤ i1 ∧ i1 ≤ BitVec.toInt o2) ∧ (55 : ℤ) < (89 : ℤ) ∧ v left2 = sum a (0 : ℤ) i1 ∧ v right2 = sum a i1 (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ i1) ∧ v bestd1 = diff a (BitVec.toInt besti) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ i1 → v bestd1 ≤ diff a j) → ((0 : ℤ) ≤ BitVec.toInt i ∧ BitVec.toInt i < BitVec.toInt (array32_length a)) ∧ (let o3 : BitVec 32 := array32_elts a (BitVec.toInt i); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ v left2 + BitVec.toInt o3 ∧ v left2 + BitVec.toInt o3 ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(left3 : big), v left3 = v left2 + BitVec.toInt o3 → ((0 : ℤ) ≤ BitVec.toInt i ∧ BitVec.toInt i < BitVec.toInt (array32_length a)) ∧ (let o4 : BitVec 32 := array32_elts a (BitVec.toInt i); (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ v right2 - BitVec.toInt o4 ∧ v right2 - BitVec.toInt o4 ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(right3 : big), v right3 = v right2 - BitVec.toInt o4 → (-((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) ≤ abs (v left3 - v right3) ∧ abs (v left3 - v right3) ≤ ((2147483647 : ℤ) + (1 : ℤ)) * ((2147483647 : ℤ) + (1 : ℤ)) - (1 : ℤ)) ∧ (∀(d : big), v d = abs (v left3 - v right3) → ((0 : ℤ) ≤ v d ∧ (0 : ℤ) ≤ v bestd1) ∧ (if v d < v bestd1 then ∀(bestd2 : big), int'32_in_bounds (BitVec.toInt i + (1 : ℤ)) ∧ (∀(o5 : BitVec 32), BitVec.toInt o5 = BitVec.toInt i + (1 : ℤ) → ((-((2147483647 : ℤ) + (1 : ℤ)) ≤ BitVec.toInt (q d) ∧ BitVec.toInt (q d) ≤ (2147483647 : ℤ) + (1 : ℤ) - (1 : ℤ)) ∧ ((0 : ℤ) ≤ BitVec.toInt (r d) ∧ BitVec.toInt (r d) ≤ (2147483647 : ℤ) + (1 : ℤ) - (1 : ℤ)) ∧ v d = BitVec.toInt (q d) * ((2147483647 : ℤ) + (1 : ℤ)) + BitVec.toInt (r d)) ∧ (v d = v bestd2 ∧ r d = r bestd2 ∧ q d = q bestd2 → (55 : ℤ) < (89 : ℤ) ∧ v left3 = sum a (0 : ℤ) (i1 + (1 : ℤ)) ∧ v right3 = sum a (i1 + (1 : ℤ)) (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt o5 ∧ BitVec.toInt o5 ≤ i1 + (1 : ℤ)) ∧ v bestd2 = diff a (BitVec.toInt o5) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ i1 + (1 : ℤ) → v bestd2 ≤ diff a j))) else (55 : ℤ) < (89 : ℤ) ∧ v left3 = sum a (0 : ℤ) (i1 + (1 : ℤ)) ∧ v right3 = sum a (i1 + (1 : ℤ)) (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ i1 + (1 : ℤ)) ∧ v bestd1 = diff a (BitVec.toInt besti) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ i1 + (1 : ℤ) → v bestd1 ≤ diff a j)))))))) ∧ ((55 : ℤ) < (89 : ℤ) ∧ v left2 = sum a (0 : ℤ) (BitVec.toInt o2 + (1 : ℤ)) ∧ v right2 = sum a (BitVec.toInt o2 + (1 : ℤ)) (BitVec.toInt n) ∧ ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ BitVec.toInt o2 + (1 : ℤ)) ∧ v bestd1 = diff a (BitVec.toInt besti) ∧ (∀(j : ℤ), (0 : ℤ) ≤ j ∧ j ≤ BitVec.toInt o2 + (1 : ℤ) → v bestd1 ≤ diff a j) → ((0 : ℤ) ≤ BitVec.toInt besti ∧ BitVec.toInt besti ≤ BitVec.toInt (array32_length a)) ∧ (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i ≤ BitVec.toInt (array32_length a) → diff a (BitVec.toInt besti) ≤ diff a i)))) ∧ (BitVec.toInt o2 + (1 : ℤ) < (0 : ℤ) → ((0 : ℤ) ≤ (0 : ℤ) ∧ (0 : ℤ) ≤ BitVec.toInt (array32_length a)) ∧ (∀(i : ℤ), (0 : ℤ) ≤ i ∧ i ≤ BitVec.toInt (array32_length a) → diff a (0 : ℤ) ≤ diff a i)))))))
  := sorry
end hillel_challenge_FulcrumNoOverflow_fulcrumqtvc
