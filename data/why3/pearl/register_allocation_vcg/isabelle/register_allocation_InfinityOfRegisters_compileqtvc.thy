theory register_allocation_InfinityOfRegisters_compileqtvc
  imports "NTP4Verif.NTP4Verif" "./register_allocation_Spec" "./register_allocation_DWP"
begin
consts identity :: "(state \<Rightarrow> bool) \<Rightarrow> state \<Rightarrow> bool"
consts exec_closure :: "instr \<Rightarrow> state \<Rightarrow> state"
axiomatization where identity_def:   "identity y = y"
  for y :: "state \<Rightarrow> bool"
axiomatization where exec_closure_def:   "exec_closure y y1 = exec y y1"
  for y :: "instr"
  and y1 :: "state"
theorem compile'vc:
  fixes e :: "expr"
  fixes r :: "int"
  shows "let o1 :: state \<Rightarrow> state \<Rightarrow> bool = expr_post e r in (case e of Evar x \<Rightarrow> (\<forall>(o2 :: wcode). wcode_ok o2 \<and> trans1 o2 = identity \<longrightarrow> wcode_ok o2) | Eneg e1 \<Rightarrow> (\<forall>(o2 :: wcode). wcode_ok o2 \<and> trans1 o2 = identity \<longrightarrow> wcode_ok o2 \<and> (\<forall>(o3 :: wcode). wcode_ok o3 \<and> trans1 o3 = rcompose (trans1 o2) (rcompose (exec_closure (Ineg r))) \<longrightarrow> (case e of Evar _ \<Rightarrow> False | Eneg f \<Rightarrow> f = e1 | Eadd f f1 \<Rightarrow> f = e1 \<or> f1 = e1) \<and> (\<forall>(o4 :: hcode). hcode_ok o4 \<and> post1 o4 = expr_post e1 r \<longrightarrow> hcode_ok o4 \<and> (\<forall>(o5 :: wcode). wcode_ok o5 \<and> trans1 o5 = to_wp (post1 o4) \<longrightarrow> wcode_ok o5 \<and> wcode_ok o3)))) | Eadd e1 e2 \<Rightarrow> (\<forall>(o2 :: wcode). wcode_ok o2 \<and> trans1 o2 = identity \<longrightarrow> wcode_ok o2 \<and> (\<forall>(o3 :: wcode). wcode_ok o3 \<and> trans1 o3 = rcompose (trans1 o2) (rcompose (exec_closure (Iadd (r + (1 :: int)) r))) \<longrightarrow> (case e of Evar _ \<Rightarrow> False | Eneg f \<Rightarrow> f = e2 | Eadd f f1 \<Rightarrow> f = e2 \<or> f1 = e2) \<and> (\<forall>(o4 :: hcode). hcode_ok o4 \<and> post1 o4 = expr_post e2 (r + (1 :: int)) \<longrightarrow> hcode_ok o4 \<and> (\<forall>(o5 :: wcode). wcode_ok o5 \<and> trans1 o5 = to_wp (post1 o4) \<longrightarrow> (case e of Evar _ \<Rightarrow> False | Eneg f \<Rightarrow> f = e1 | Eadd f f1 \<Rightarrow> f = e1 \<or> f1 = e1) \<and> (\<forall>(o6 :: hcode). hcode_ok o6 \<and> post1 o6 = expr_post e1 r \<longrightarrow> hcode_ok o6 \<and> (\<forall>(o7 :: wcode). wcode_ok o7 \<and> trans1 o7 = to_wp (post1 o6) \<longrightarrow> (wcode_ok o7 \<and> wcode_ok o5) \<and> (\<forall>(o8 :: wcode). wcode_ok o8 \<and> trans1 o8 = rcompose (trans1 o5) (trans1 o7) \<longrightarrow> wcode_ok o8 \<and> wcode_ok o3)))))))) \<and> (\<forall>(o2 :: wcode). (case e of Evar x \<Rightarrow> (\<exists>(o3 :: wcode). (wcode_ok o3 \<and> trans1 o3 = identity) \<and> wcode_ok o2 \<and> trans1 o2 = rcompose (trans1 o3) (rcompose (exec_closure (Iload x r)))) | Eneg e1 \<Rightarrow> (\<exists>(o3 :: wcode). (wcode_ok o3 \<and> trans1 o3 = identity) \<and> (\<exists>(o4 :: wcode). (wcode_ok o4 \<and> trans1 o4 = rcompose (trans1 o3) (rcompose (exec_closure (Ineg r)))) \<and> (\<exists>(o5 :: hcode). (hcode_ok o5 \<and> post1 o5 = expr_post e1 r) \<and> (\<exists>(o6 :: wcode). (wcode_ok o6 \<and> trans1 o6 = to_wp (post1 o5)) \<and> wcode_ok o2 \<and> trans1 o2 = rcompose (trans1 o4) (trans1 o6))))) | Eadd e1 e2 \<Rightarrow> (\<exists>(o3 :: wcode). (wcode_ok o3 \<and> trans1 o3 = identity) \<and> (\<exists>(o4 :: wcode). (wcode_ok o4 \<and> trans1 o4 = rcompose (trans1 o3) (rcompose (exec_closure (Iadd (r + (1 :: int)) r)))) \<and> (\<exists>(o5 :: hcode). (hcode_ok o5 \<and> post1 o5 = expr_post e2 (r + (1 :: int))) \<and> (\<exists>(o6 :: wcode). (wcode_ok o6 \<and> trans1 o6 = to_wp (post1 o5)) \<and> (\<exists>(o7 :: hcode). (hcode_ok o7 \<and> post1 o7 = expr_post e1 r) \<and> (\<exists>(o8 :: wcode). (wcode_ok o8 \<and> trans1 o8 = to_wp (post1 o7)) \<and> (\<exists>(o9 :: wcode). (wcode_ok o9 \<and> trans1 o9 = rcompose (trans1 o6) (trans1 o8)) \<and> wcode_ok o2 \<and> trans1 o2 = rcompose (trans1 o4) (trans1 o9))))))))) \<longrightarrow> (wcode_ok o2 \<and> (\<forall>(x :: state). trans1 o2 (o1 x) x = True)) \<and> (\<forall>(result :: hcode). hcode_ok result \<and> post1 result = o1 \<longrightarrow> hcode_ok result \<and> post1 result = expr_post e r))"
  sorry
end
