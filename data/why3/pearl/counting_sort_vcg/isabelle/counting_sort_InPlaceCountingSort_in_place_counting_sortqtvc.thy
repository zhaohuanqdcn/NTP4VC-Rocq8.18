theory counting_sort_InPlaceCountingSort_in_place_counting_sortqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "Why3STD.int_NumOf" "./counting_sort_Spec" "Why3STD.array_IntArraySorted"
begin
theorem in_place_counting_sort'vc:
  fixes a :: "int list"
  assumes fact0: "k_values a"
  shows "let o1 :: int = k in (0 :: int) \<le> o1 \<and> (\<forall>(c :: int list). (\<forall>(i :: int). (0 :: int) \<le> i \<and> i < o1 \<longrightarrow> c ! nat i = (0 :: int)) \<and> int (length c) = o1 \<longrightarrow> (let o2 :: int = int (length a) - (1 :: int) in ((0 :: int) \<le> o2 + (1 :: int) \<longrightarrow> (\<forall>(v :: int). (0 :: int) \<le> v \<and> v < k \<longrightarrow> c ! nat v = numeq a v (0 :: int) (0 :: int)) \<and> (\<forall>(c1 :: int list). length c1 = length c \<longrightarrow> (\<forall>(i :: int). ((0 :: int) \<le> i \<and> i \<le> o2) \<and> (\<forall>(v :: int). (0 :: int) \<le> v \<and> v < k \<longrightarrow> c1 ! nat v = numeq a v (0 :: int) i) \<longrightarrow> ((0 :: int) \<le> i \<and> i < int (length a)) \<and> (let v :: int = a ! nat i in ((0 :: int) \<le> v \<and> v < int (length c1)) \<and> (let o3 :: int = c1 ! nat v + (1 :: int) in ((0 :: int) \<le> v \<and> v < int (length c1)) \<and> (length (c1[nat v := o3]) = length c1 \<longrightarrow> nth (c1[nat v := o3]) o nat = (nth c1 o nat)(v := o3) \<longrightarrow> (\<forall>(v1 :: int). (0 :: int) \<le> v1 \<and> v1 < k \<longrightarrow> c1[nat v := o3] ! nat v1 = numeq a v1 (0 :: int) (i + (1 :: int))))))) \<and> ((\<forall>(v :: int). (0 :: int) \<le> v \<and> v < k \<longrightarrow> c1 ! nat v = numeq a v (0 :: int) (o2 + (1 :: int))) \<longrightarrow> (let o3 :: int = k - (1 :: int) in ((0 :: int) \<le> o3 + (1 :: int) \<longrightarrow> ((0 :: int) = numlt a (0 :: int) (0 :: int) (int (length a)) \<and> sorted_sub1 a (0 :: int) (0 :: int) \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < (0 :: int) \<longrightarrow> (0 :: int) \<le> a ! nat e \<and> a ! nat e < (0 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < (0 :: int) \<longrightarrow> numeq a f (0 :: int) (0 :: int) = numeq a f (0 :: int) (int (length a)))) \<and> (\<forall>(j :: int) (a1 :: int list). length a1 = length a \<longrightarrow> (\<forall>(v :: int). ((0 :: int) \<le> v \<and> v \<le> o3) \<and> j = numlt a v (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e < v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1))) \<longrightarrow> ((0 :: int) \<le> v \<and> v < int (length c1)) \<and> (let o4 :: int = c1 ! nat v in ((1 :: int) \<le> o4 + (1 :: int) \<longrightarrow> (j - (1 :: int) + (1 :: int) = numlt a v (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1))) \<and> numeq a1 v (0 :: int) j = (1 :: int) - (1 :: int)) \<and> (\<forall>(j1 :: int) (a2 :: int list). length a2 = length a1 \<longrightarrow> (\<forall>(i :: int). ((1 :: int) \<le> i \<and> i \<le> o4) \<and> j1 - i + (1 :: int) = numlt a v (0 :: int) (int (length a2)) \<and> sorted_sub1 a2 (0 :: int) j1 \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 \<longrightarrow> (0 :: int) \<le> a2 ! nat e \<and> a2 ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a2 f (0 :: int) j1 = numeq a f (0 :: int) (int (length a2))) \<and> numeq a2 v (0 :: int) j1 = i - (1 :: int) \<longrightarrow> ((0 :: int) \<le> j1 \<and> j1 < int (length a2)) \<and> (length (a2[nat j1 := v]) = length a2 \<longrightarrow> nth (a2[nat j1 := v]) o nat = (nth a2 o nat)(j1 := v) \<longrightarrow> j1 + (1 :: int) - (i + (1 :: int)) + (1 :: int) = numlt a v (0 :: int) (int (length (a2[nat j1 := v]))) \<and> sorted_sub1 (a2[nat j1 := v]) (0 :: int) (j1 + (1 :: int)) \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 + (1 :: int) \<longrightarrow> (0 :: int) \<le> a2[nat j1 := v] ! nat e \<and> a2[nat j1 := v] ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq (a2[nat j1 := v]) f (0 :: int) (j1 + (1 :: int)) = numeq a f (0 :: int) (int (length (a2[nat j1 := v])))) \<and> numeq (a2[nat j1 := v]) v (0 :: int) (j1 + (1 :: int)) = i + (1 :: int) - (1 :: int))) \<and> (j1 - (o4 + (1 :: int)) + (1 :: int) = numlt a v (0 :: int) (int (length a2)) \<and> sorted_sub1 a2 (0 :: int) j1 \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 \<longrightarrow> (0 :: int) \<le> a2 ! nat e \<and> a2 ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a2 f (0 :: int) j1 = numeq a f (0 :: int) (int (length a2))) \<and> numeq a2 v (0 :: int) j1 = o4 + (1 :: int) - (1 :: int) \<longrightarrow> j1 = numlt a (v + (1 :: int)) (0 :: int) (int (length a2)) \<and> sorted_sub1 a2 (0 :: int) j1 \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 \<longrightarrow> (0 :: int) \<le> a2 ! nat e \<and> a2 ! nat e < v + (1 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v + (1 :: int) \<longrightarrow> numeq a2 f (0 :: int) j1 = numeq a f (0 :: int) (int (length a2)))))) \<and> (o4 + (1 :: int) < (1 :: int) \<longrightarrow> j = numlt a (v + (1 :: int)) (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e < v + (1 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v + (1 :: int) \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1)))))) \<and> (j = numlt a (o3 + (1 :: int)) (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e < o3 + (1 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < o3 + (1 :: int) \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1))) \<longrightarrow> array_IntArraySorted.sorted a1 \<and> permut a a1))) \<and> (o3 + (1 :: int) < (0 :: int) \<longrightarrow> array_IntArraySorted.sorted a \<and> permut a a))))) \<and> (o2 + (1 :: int) < (0 :: int) \<longrightarrow> (let o3 :: int = k - (1 :: int) in ((0 :: int) \<le> o3 + (1 :: int) \<longrightarrow> ((0 :: int) = numlt a (0 :: int) (0 :: int) (int (length a)) \<and> sorted_sub1 a (0 :: int) (0 :: int) \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < (0 :: int) \<longrightarrow> (0 :: int) \<le> a ! nat e \<and> a ! nat e < (0 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < (0 :: int) \<longrightarrow> numeq a f (0 :: int) (0 :: int) = numeq a f (0 :: int) (int (length a)))) \<and> (\<forall>(j :: int) (a1 :: int list). length a1 = length a \<longrightarrow> (\<forall>(v :: int). ((0 :: int) \<le> v \<and> v \<le> o3) \<and> j = numlt a v (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e < v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1))) \<longrightarrow> ((0 :: int) \<le> v \<and> v < int (length c)) \<and> (let o4 :: int = c ! nat v in ((1 :: int) \<le> o4 + (1 :: int) \<longrightarrow> (j - (1 :: int) + (1 :: int) = numlt a v (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1))) \<and> numeq a1 v (0 :: int) j = (1 :: int) - (1 :: int)) \<and> (\<forall>(j1 :: int) (a2 :: int list). length a2 = length a1 \<longrightarrow> (\<forall>(i :: int). ((1 :: int) \<le> i \<and> i \<le> o4) \<and> j1 - i + (1 :: int) = numlt a v (0 :: int) (int (length a2)) \<and> sorted_sub1 a2 (0 :: int) j1 \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 \<longrightarrow> (0 :: int) \<le> a2 ! nat e \<and> a2 ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a2 f (0 :: int) j1 = numeq a f (0 :: int) (int (length a2))) \<and> numeq a2 v (0 :: int) j1 = i - (1 :: int) \<longrightarrow> ((0 :: int) \<le> j1 \<and> j1 < int (length a2)) \<and> (length (a2[nat j1 := v]) = length a2 \<longrightarrow> nth (a2[nat j1 := v]) o nat = (nth a2 o nat)(j1 := v) \<longrightarrow> j1 + (1 :: int) - (i + (1 :: int)) + (1 :: int) = numlt a v (0 :: int) (int (length (a2[nat j1 := v]))) \<and> sorted_sub1 (a2[nat j1 := v]) (0 :: int) (j1 + (1 :: int)) \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 + (1 :: int) \<longrightarrow> (0 :: int) \<le> a2[nat j1 := v] ! nat e \<and> a2[nat j1 := v] ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq (a2[nat j1 := v]) f (0 :: int) (j1 + (1 :: int)) = numeq a f (0 :: int) (int (length (a2[nat j1 := v])))) \<and> numeq (a2[nat j1 := v]) v (0 :: int) (j1 + (1 :: int)) = i + (1 :: int) - (1 :: int))) \<and> (j1 - (o4 + (1 :: int)) + (1 :: int) = numlt a v (0 :: int) (int (length a2)) \<and> sorted_sub1 a2 (0 :: int) j1 \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 \<longrightarrow> (0 :: int) \<le> a2 ! nat e \<and> a2 ! nat e \<le> v) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v \<longrightarrow> numeq a2 f (0 :: int) j1 = numeq a f (0 :: int) (int (length a2))) \<and> numeq a2 v (0 :: int) j1 = o4 + (1 :: int) - (1 :: int) \<longrightarrow> j1 = numlt a (v + (1 :: int)) (0 :: int) (int (length a2)) \<and> sorted_sub1 a2 (0 :: int) j1 \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j1 \<longrightarrow> (0 :: int) \<le> a2 ! nat e \<and> a2 ! nat e < v + (1 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v + (1 :: int) \<longrightarrow> numeq a2 f (0 :: int) j1 = numeq a f (0 :: int) (int (length a2)))))) \<and> (o4 + (1 :: int) < (1 :: int) \<longrightarrow> j = numlt a (v + (1 :: int)) (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e < v + (1 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < v + (1 :: int) \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1)))))) \<and> (j = numlt a (o3 + (1 :: int)) (0 :: int) (int (length a1)) \<and> sorted_sub1 a1 (0 :: int) j \<and> (\<forall>(e :: int). (0 :: int) \<le> e \<and> e < j \<longrightarrow> (0 :: int) \<le> a1 ! nat e \<and> a1 ! nat e < o3 + (1 :: int)) \<and> (\<forall>(f :: int). (0 :: int) \<le> f \<and> f < o3 + (1 :: int) \<longrightarrow> numeq a1 f (0 :: int) j = numeq a f (0 :: int) (int (length a1))) \<longrightarrow> array_IntArraySorted.sorted a1 \<and> permut a a1))) \<and> (o3 + (1 :: int) < (0 :: int) \<longrightarrow> array_IntArraySorted.sorted a \<and> permut a a)))))"
  sorry
end
