theory string_base64_encoding_Base64_b642intqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.string_StringBuffer"
begin
definition int2b64 :: "int \<Rightarrow> char"
  where "int2b64 i = (if (0 :: int) \<le> i \<and> i \<le> (25 :: int) then char_of (i + (65 :: int)) else if (26 :: int) \<le> i \<and> i \<le> (51 :: int) then char_of (i - (26 :: int) + (97 :: int)) else if (52 :: int) \<le> i \<and> i \<le> (61 :: int) then char_of (i - (52 :: int) + (48 :: int)) else if i = (62 :: int) then char_of (43 :: int) else if i = (63 :: int) then char_of (47 :: int) else char_of (0 :: int))" for i
definition valid_b64_char :: "char \<Rightarrow> _"
  where "valid_b64_char c \<longleftrightarrow> (65 :: int) \<le> of_char c \<and> of_char c \<le> (90 :: int) \<or> (97 :: int) \<le> of_char c \<and> of_char c \<le> (122 :: int) \<or> (48 :: int) \<le> of_char c \<and> of_char c \<le> (57 :: int) \<or> of_char c = (43 :: int) \<or> of_char c = (47 :: int)" for c
definition b642int :: "char \<Rightarrow> int"
  where "b642int c = (if (65 :: int) \<le> of_char c \<and> of_char c \<le> (90 :: int) then of_char c - (65 :: int) else if (97 :: int) \<le> of_char c \<and> of_char c \<le> (122 :: int) then of_char c - (97 :: int) + (26 :: int) else if (48 :: int) \<le> of_char c \<and> of_char c \<le> (57 :: int) then of_char c - (48 :: int) + (52 :: int) else if of_char c = (43 :: int) then 62 :: int else if of_char c = (47 :: int) then 63 :: int else if c = char_of (sint (61 :: 63 word)) then 0 :: int else (64 :: int))" for c
theorem b642int'vc:
  fixes c :: "char"
  fixes q1' :: "63 word"
  fixes o1 :: "bool"
  assumes fact0: "valid_b64_char c \<or> c = char_of (sint (61 :: 63 word))"
  assumes fact1: "sint q1' = of_char c"
  assumes fact2: "if (65 :: int) \<le> sint q1' then o1 = (if sint q1' \<le> (90 :: int) then True else False) else o1 = False"
  shows "if o1 = True then \<forall>(o2 :: 63 word). sint o2 = of_char c \<longrightarrow> int'63_in_bounds (sint o2 - (65 :: int)) else \<forall>(o2 :: bool). (\<exists>(q1_1 :: 63 word). sint q1_1 = of_char c \<and> (if (97 :: int) \<le> sint q1_1 then o2 = (if sint q1_1 \<le> (122 :: int) then True else False) else o2 = False)) \<longrightarrow> (if o2 = True then \<forall>(o3 :: 63 word). sint o3 = of_char c \<longrightarrow> int'63_in_bounds (sint o3 - (97 :: int)) \<and> (\<forall>(o4 :: 63 word). sint o4 = sint o3 - (97 :: int) \<longrightarrow> int'63_in_bounds (sint o4 + (26 :: int))) else \<forall>(o3 :: bool). (\<exists>(q1_1 :: 63 word). sint q1_1 = of_char c \<and> (if (48 :: int) \<le> sint q1_1 then o3 = (if sint q1_1 \<le> (57 :: int) then True else False) else o3 = False)) \<longrightarrow> (if o3 = True then \<forall>(o4 :: 63 word). sint o4 = of_char c \<longrightarrow> int'63_in_bounds (sint o4 - (48 :: int)) \<and> (\<forall>(o5 :: 63 word). sint o5 = sint o4 - (48 :: int) \<longrightarrow> int'63_in_bounds (sint o5 + (52 :: int))) else \<forall>(o4 :: 63 word). sint o4 = of_char c \<longrightarrow> (sint o4 = (43 :: int) \<longrightarrow> o4 = (43 :: 63 word)) \<longrightarrow> \<not>o4 = (43 :: 63 word) \<longrightarrow> (\<forall>(o5 :: 63 word). sint o5 = of_char c \<longrightarrow> (sint o5 = (47 :: int) \<longrightarrow> o5 = (47 :: 63 word)) \<longrightarrow> \<not>o5 = (47 :: 63 word) \<longrightarrow> c = char_of (sint (61 :: 63 word)))))"
  and "\<forall>(result :: 63 word). (if o1 = True then \<exists>(o2 :: 63 word). sint o2 = of_char c \<and> sint result = sint o2 - (65 :: int) else \<exists>(o2 :: bool). (\<exists>(q1_1 :: 63 word). sint q1_1 = of_char c \<and> (if (97 :: int) \<le> sint q1_1 then o2 = (if sint q1_1 \<le> (122 :: int) then True else False) else o2 = False)) \<and> (if o2 = True then \<exists>(o3 :: 63 word). sint o3 = of_char c \<and> (\<exists>(o4 :: 63 word). sint o4 = sint o3 - (97 :: int) \<and> sint result = sint o4 + (26 :: int)) else \<exists>(o3 :: bool). (\<exists>(q1_1 :: 63 word). sint q1_1 = of_char c \<and> (if (48 :: int) \<le> sint q1_1 then o3 = (if sint q1_1 \<le> (57 :: int) then True else False) else o3 = False)) \<and> (if o3 = True then \<exists>(o4 :: 63 word). sint o4 = of_char c \<and> (\<exists>(o5 :: 63 word). sint o5 = sint o4 - (48 :: int) \<and> sint result = sint o5 + (52 :: int)) else \<exists>(o4 :: 63 word). sint o4 = of_char c \<and> (sint o4 = (43 :: int) \<longrightarrow> o4 = (43 :: 63 word)) \<and> (if o4 = (43 :: 63 word) then result = (62 :: 63 word) else \<exists>(o5 :: 63 word). sint o5 = of_char c \<and> (sint o5 = (47 :: int) \<longrightarrow> o5 = (47 :: 63 word)) \<and> (if o5 = (47 :: 63 word) then result = (63 :: 63 word) else c = char_of (sint (61 :: 63 word)) \<and> result = (0 :: 63 word)))))) \<longrightarrow> sint result = b642int c"
  sorry
end
