theory mpz_cmp_Zcmp_wmpz_cmpqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "Why3STD.map_Const" "Why3STD.map_MapEq" "mach.int_Unsigned" "mach.c_C" "../../lib/isabelle/lemmas_Lemmas" "../../lib/isabelle/types_Config" "../../lib/isabelle/types_Types" "../../lib/isabelle/types_Int32Eq" "../../lib/isabelle/types_UInt64Eq" "../../lib/isabelle/compare_Compare" "../../lib/isabelle/ptralias_Alias" "../../lib/isabelle/mpz_Z" "../../lib/isabelle/mpz_Zutil"
begin
theorem wmpz_cmp'vc:
  fixes mpz :: "mpz_memo"
  fixes u :: "mpz_ptr"
  fixes v :: "mpz_ptr"
  assumes fact0: "(0 :: int) \<le> readers mpz u"
  assumes fact1: "(0 :: int) \<le> readers mpz v"
  assumes fact2: "int'32_in_bounds (sgn mpz u * abs_size mpz u - sgn mpz v * abs_size mpz v)"
  shows "-(2 :: int) < readers mpz u"
  and "\<forall>(usize :: 32 word). sint usize = sgn mpz u * abs_size mpz u \<longrightarrow> -(2 :: int) < readers mpz v \<and> (\<forall>(vsize :: 32 word). sint vsize = sgn mpz v * abs_size mpz v \<longrightarrow> int'32_in_bounds (sint usize - sint vsize) \<and> (\<forall>(dsize :: 32 word). sint dsize = sint usize - sint vsize \<longrightarrow> (sint dsize = (0 :: int) \<longrightarrow> dsize = (0 :: 32 word)) \<longrightarrow> (if \<not>dsize = (0 :: 32 word) then (\<forall>(w :: mpz_ptr). mpz_unchanged w mpz mpz) \<and> ((0 :: int) < sint dsize \<longrightarrow> value_of v mpz < value_of u mpz) \<and> (sint dsize < (0 :: int) \<longrightarrow> value_of u mpz < value_of v mpz) \<and> (sint dsize = (0 :: int) \<longrightarrow> value_of u mpz = value_of v mpz) else -(2147483648 :: int) < sint usize \<and> (\<forall>(asize :: 32 word). sint asize = abs (sint usize) \<longrightarrow> (0 :: int) \<le> readers mpz u \<and> (\<forall>(mpz1 :: mpz_memo). abs_value_of mpz1 = abs_value_of mpz \<and> alloc mpz1 = alloc mpz \<and> abs_size mpz1 = abs_size mpz \<and> sgn mpz1 = sgn mpz \<and> zones mpz1 = zones mpz \<longrightarrow> (\<forall>(up :: 64 word ptr). readers mpz1 u = readers mpz u + (1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>u = y \<longrightarrow> readers mpz1 y = readers mpz y) \<and> value up (abs_size mpz1 u) = abs_value_of mpz1 u \<and> plength up = alloc mpz1 u \<and> offset up = (0 :: int) \<and> c_C.min up = (0 :: int) \<and> c_C.max up = plength up \<and> zone1 up = zones mpz1 u \<longrightarrow> (0 :: int) \<le> readers mpz1 v \<and> (\<forall>(mpz2 :: mpz_memo). abs_value_of mpz2 = abs_value_of mpz1 \<and> alloc mpz2 = alloc mpz1 \<and> abs_size mpz2 = abs_size mpz1 \<and> sgn mpz2 = sgn mpz1 \<and> zones mpz2 = zones mpz1 \<longrightarrow> (\<forall>(vp :: 64 word ptr). readers mpz2 v = readers mpz1 v + (1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>v = y \<longrightarrow> readers mpz2 y = readers mpz1 y) \<and> value vp (abs_size mpz2 v) = abs_value_of mpz2 v \<and> plength vp = alloc mpz2 v \<and> offset vp = (0 :: int) \<and> c_C.min vp = (0 :: int) \<and> c_C.max vp = plength vp \<and> zone1 vp = zones mpz2 v \<longrightarrow> (valid up (sint asize) \<and> valid vp (sint asize)) \<and> (\<forall>(cmp :: 32 word). sint cmp = compare_int (value up (sint asize)) (value vp (sint asize)) \<longrightarrow> (zones mpz2 u = zone1 up \<and> (1 :: int) \<le> readers mpz2 u \<and> c_C.min up = (0 :: int) \<and> c_C.max up = plength up) \<and> (\<forall>(mpz3 :: mpz_memo). abs_value_of mpz3 = abs_value_of mpz2 \<and> alloc mpz3 = alloc mpz2 \<and> abs_size mpz3 = abs_size mpz2 \<and> sgn mpz3 = sgn mpz2 \<and> zones mpz3 = zones mpz2 \<longrightarrow> readers mpz3 u = readers mpz2 u - (1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>y = u \<longrightarrow> readers mpz3 y = readers mpz2 y) \<longrightarrow> (zones mpz3 v = zone1 vp \<and> (1 :: int) \<le> readers mpz3 v \<and> c_C.min vp = (0 :: int) \<and> c_C.max vp = plength vp) \<and> (\<forall>(mpz4 :: mpz_memo). abs_value_of mpz4 = abs_value_of mpz3 \<and> alloc mpz4 = alloc mpz3 \<and> abs_size mpz4 = abs_size mpz3 \<and> sgn mpz4 = sgn mpz3 \<and> zones mpz4 = zones mpz3 \<longrightarrow> readers mpz4 v = readers mpz3 v - (1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>y = v \<longrightarrow> readers mpz4 y = readers mpz3 y) \<longrightarrow> (\<not>(0 :: int) \<le> sint usize \<longrightarrow> int'32_in_bounds (-sint cmp)) \<and> (\<forall>(r :: 32 word). (if (0 :: int) \<le> sint usize then r = cmp else sint r = -sint cmp) \<longrightarrow> (\<forall>(w :: mpz_ptr). mpz_unchanged w mpz4 mpz) \<and> ((0 :: int) < sint r \<longrightarrow> value_of v mpz4 < value_of u mpz4) \<and> (sint r < (0 :: int) \<longrightarrow> value_of u mpz4 < value_of v mpz4) \<and> (sint r = (0 :: int) \<longrightarrow> value_of u mpz4 = value_of v mpz4)))))))))))))"
  sorry
end
