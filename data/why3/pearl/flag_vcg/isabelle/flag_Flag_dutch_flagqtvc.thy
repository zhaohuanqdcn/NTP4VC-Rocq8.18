theory flag_Flag_dutch_flagqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "Why3STD.map_MapEq" "Why3STD.map_MapExchange" "Why3STD.map_MapPermut"
begin
datatype  color = Blue | White | Red
definition monochrome :: "color list \<Rightarrow> int \<Rightarrow> int \<Rightarrow> color \<Rightarrow> _"
  where "monochrome a i j c \<longleftrightarrow> (\<forall>(k :: int). i \<le> k \<and> k < j \<longrightarrow> a ! nat k = c)" for a i j c
theorem dutch_flag'vc:
  fixes a :: "color list"
  shows "let o1 :: int = int (length a) in (((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> o1 \<and> o1 \<le> int (length a)) \<and> monochrome a (0 :: int) (0 :: int) Blue \<and> monochrome a (0 :: int) (0 :: int) White \<and> monochrome a o1 (int (length a)) Red \<and> a <~~> a) \<and> (\<forall>(r :: int) (i :: int) (b :: int) (a1 :: color list). length a1 = length a \<longrightarrow> ((0 :: int) \<le> b \<and> b \<le> i \<and> i \<le> r \<and> r \<le> int (length a1)) \<and> monochrome a1 (0 :: int) b Blue \<and> monochrome a1 b i White \<and> monochrome a1 r (int (length a1)) Red \<and> a <~~> a1 \<longrightarrow> (if i < r then ((0 :: int) \<le> i \<and> i < int (length a1)) \<and> (case a1 ! nat i of Blue \<Rightarrow> (((0 :: int) \<le> b \<and> b < int (length a1)) \<and> (0 :: int) \<le> i \<and> i < int (length a1)) \<and> (\<forall>(a2 :: color list). length a2 = length a1 \<longrightarrow> list_exchange a1 a2 b i \<longrightarrow> ((0 :: int) \<le> r - i \<and> r - (i + (1 :: int)) < r - i) \<and> ((0 :: int) \<le> b + (1 :: int) \<and> b + (1 :: int) \<le> i + (1 :: int) \<and> i + (1 :: int) \<le> r \<and> r \<le> int (length a2)) \<and> monochrome a2 (0 :: int) (b + (1 :: int)) Blue \<and> monochrome a2 (b + (1 :: int)) (i + (1 :: int)) White \<and> monochrome a2 r (int (length a2)) Red \<and> a <~~> a2) | White \<Rightarrow> ((0 :: int) \<le> r - i \<and> r - (i + (1 :: int)) < r - i) \<and> ((0 :: int) \<le> b \<and> b \<le> i + (1 :: int) \<and> i + (1 :: int) \<le> r \<and> r \<le> int (length a1)) \<and> monochrome a1 (0 :: int) b Blue \<and> monochrome a1 b (i + (1 :: int)) White \<and> monochrome a1 r (int (length a1)) Red \<and> a <~~> a1 | Red \<Rightarrow> (((0 :: int) \<le> r - (1 :: int) \<and> r - (1 :: int) < int (length a1)) \<and> (0 :: int) \<le> i \<and> i < int (length a1)) \<and> (\<forall>(a2 :: color list). length a2 = length a1 \<longrightarrow> list_exchange a1 a2 (r - (1 :: int)) i \<longrightarrow> ((0 :: int) \<le> r - i \<and> r - (1 :: int) - i < r - i) \<and> ((0 :: int) \<le> b \<and> b \<le> i \<and> i \<le> r - (1 :: int) \<and> r - (1 :: int) \<le> int (length a2)) \<and> monochrome a2 (0 :: int) b Blue \<and> monochrome a2 b i White \<and> monochrome a2 (r - (1 :: int)) (int (length a2)) Red \<and> a <~~> a2)) else (\<exists>(b1 :: int) (r1 :: int). monochrome a1 (0 :: int) b1 Blue \<and> monochrome a1 b1 r1 White \<and> monochrome a1 r1 (int (length a1)) Red) \<and> a <~~> a1))"
  sorry
end
