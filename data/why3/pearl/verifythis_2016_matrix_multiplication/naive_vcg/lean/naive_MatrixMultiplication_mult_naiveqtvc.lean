import Why3.Base
import Why3.int.Sum
import Why3.matrix.Matrix
open Classical
open Lean4Why3
namespace naive_MatrixMultiplication_mult_naiveqtvc
axiom mul_atom : Matrix.matrix ℤ -> Matrix.matrix ℤ -> ℤ -> ℤ -> ℤ -> ℤ
axiom mul_atom'def (a : Matrix.matrix ℤ) (b : Matrix.matrix ℤ) (i : ℤ) (j : ℤ) (k : ℤ) : mul_atom a b i j k = Matrix.elts a i k * Matrix.elts b k j
noncomputable def matrix_product (m : Matrix.matrix ℤ) (a : Matrix.matrix ℤ) (b : Matrix.matrix ℤ) := ∀(i : ℤ) (j : ℤ), (0 : ℤ) ≤ i ∧ i < Matrix.rows m → (0 : ℤ) ≤ j ∧ j < Matrix.columns m → Matrix.elts m i j = int.Sum.sum (mul_atom a b i j) (0 : ℤ) (Matrix.columns a)
theorem mult_naive'vc (a : Matrix.matrix ℤ) (b : Matrix.matrix ℤ) (fact0 : Matrix.columns a = Matrix.rows b) : let o1 : ℤ := Matrix.columns b; let o2 : ℤ := Matrix.rows a; ((0 : ℤ) ≤ o2 ∧ (0 : ℤ) ≤ o1) ∧ (∀(rs : Matrix.matrix ℤ), Matrix.rows rs = o2 ∧ Matrix.columns rs = o1 ∧ (∀(i : ℤ) (j : ℤ), ((0 : ℤ) ≤ i ∧ i < o2) ∧ (0 : ℤ) ≤ j ∧ j < o1 → Matrix.elts rs i j = (0 : ℤ)) → (let o3 : ℤ := Matrix.rows a - (1 : ℤ); ((0 : ℤ) ≤ o3 + (1 : ℤ) → ((∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs i0 j0 = (0 : ℤ)) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < (0 : ℤ)) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs i0 j0 = int.Sum.sum (mul_atom a b i0 j0) (0 : ℤ) (Matrix.columns a))) ∧ (∀(rs1 : Matrix.matrix ℤ), Matrix.rows rs1 = Matrix.rows rs ∧ Matrix.columns rs1 = Matrix.columns rs → (∀(i : ℤ), ((0 : ℤ) ≤ i ∧ i ≤ o3) ∧ (∀(i0 : ℤ) (j0 : ℤ), (i ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i0 j0 = (0 : ℤ)) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < i) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i0 j0 = int.Sum.sum (mul_atom a b i0 j0) (0 : ℤ) (Matrix.columns a)) → (let o4 : ℤ := Matrix.rows b - (1 : ℤ); ((0 : ℤ) ≤ o4 + (1 : ℤ) → (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (0 : ℤ)) ∧ (∀(rs2 : Matrix.matrix ℤ), Matrix.rows rs2 = Matrix.rows rs1 ∧ Matrix.columns rs2 = Matrix.columns rs1 → (∀(k : ℤ), ((0 : ℤ) ≤ k ∧ k ≤ o4) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i → Matrix.elts rs2 i0 j0 = Matrix.elts rs1 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs2 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) k) → (let o5 : ℤ := Matrix.columns b - (1 : ℤ); ((0 : ℤ) ≤ o5 + (1 : ℤ) → (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < (0 : ℤ) → Matrix.elts rs2 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (k + (1 : ℤ))) ∧ (∀(rs3 : Matrix.matrix ℤ), Matrix.rows rs3 = Matrix.rows rs2 ∧ Matrix.columns rs3 = Matrix.columns rs2 → (∀(j : ℤ), ((0 : ℤ) ≤ j ∧ j ≤ o5) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i ∨ j ≤ j0 → Matrix.elts rs3 i0 j0 = Matrix.elts rs2 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < j → Matrix.elts rs3 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (k + (1 : ℤ))) → Matrix.valid_index b k j ∧ Matrix.valid_index a i k ∧ Matrix.valid_index rs3 i j ∧ Matrix.valid_index rs3 i j ∧ (∀(rs4 : Matrix.matrix ℤ), Matrix.rows rs4 = Matrix.rows rs3 ∧ Matrix.columns rs4 = Matrix.columns rs3 → Matrix.elts rs4 = Function.update (Matrix.elts rs3) i (Function.update (Matrix.elts rs3 i) j (Matrix.elts rs3 i j + Matrix.elts a i k * Matrix.elts b k j)) → (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i ∨ j + (1 : ℤ) ≤ j0 → Matrix.elts rs4 i0 j0 = Matrix.elts rs2 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < j + (1 : ℤ) → Matrix.elts rs4 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (k + (1 : ℤ))))) ∧ ((∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i ∨ o5 + (1 : ℤ) ≤ j0 → Matrix.elts rs3 i0 j0 = Matrix.elts rs2 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < o5 + (1 : ℤ) → Matrix.elts rs3 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (k + (1 : ℤ))) → (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i → Matrix.elts rs3 i0 j0 = Matrix.elts rs1 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs3 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (k + (1 : ℤ)))))) ∧ (o5 + (1 : ℤ) < (0 : ℤ) → (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i → Matrix.elts rs2 i0 j0 = Matrix.elts rs1 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs2 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (k + (1 : ℤ)))))) ∧ ((∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → ¬i0 = i → Matrix.elts rs2 i0 j0 = Matrix.elts rs1 i0 j0) ∧ (∀(j0 : ℤ), (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs2 i j0 = int.Sum.sum (mul_atom a b i j0) (0 : ℤ) (o4 + (1 : ℤ))) → (∀(i0 : ℤ) (j0 : ℤ), (i + (1 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs2 i0 j0 = (0 : ℤ)) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < i + (1 : ℤ)) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs2 i0 j0 = int.Sum.sum (mul_atom a b i0 j0) (0 : ℤ) (Matrix.columns a))))) ∧ (o4 + (1 : ℤ) < (0 : ℤ) → (∀(i0 : ℤ) (j0 : ℤ), (i + (1 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i0 j0 = (0 : ℤ)) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < i + (1 : ℤ)) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i0 j0 = int.Sum.sum (mul_atom a b i0 j0) (0 : ℤ) (Matrix.columns a))))) ∧ ((∀(i0 : ℤ) (j0 : ℤ), (o3 + (1 : ℤ) ≤ i0 ∧ i0 < Matrix.rows a) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i0 j0 = (0 : ℤ)) ∧ (∀(i0 : ℤ) (j0 : ℤ), ((0 : ℤ) ≤ i0 ∧ i0 < o3 + (1 : ℤ)) ∧ (0 : ℤ) ≤ j0 ∧ j0 < Matrix.columns b → Matrix.elts rs1 i0 j0 = int.Sum.sum (mul_atom a b i0 j0) (0 : ℤ) (Matrix.columns a)) → (Matrix.rows rs1 = Matrix.rows a ∧ Matrix.columns rs1 = Matrix.columns b) ∧ matrix_product rs1 a b))) ∧ (o3 + (1 : ℤ) < (0 : ℤ) → (Matrix.rows rs = Matrix.rows a ∧ Matrix.columns rs = Matrix.columns b) ∧ matrix_product rs a b)))
  := sorry
end naive_MatrixMultiplication_mult_naiveqtvc
