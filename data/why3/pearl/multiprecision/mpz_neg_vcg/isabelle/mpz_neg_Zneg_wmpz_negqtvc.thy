theory mpz_neg_Zneg_wmpz_negqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "Why3STD.map_Const" "Why3STD.map_MapEq" "mach.int_Unsigned" "mach.c_C" "../../lib/isabelle/lemmas_Lemmas" "../../lib/isabelle/types_Config" "../../lib/isabelle/types_Types" "../../lib/isabelle/types_Int32Eq" "../../lib/isabelle/types_UInt64Eq" "../../lib/isabelle/util_Util" "../../lib/isabelle/ptralias_Alias" "../../lib/isabelle/compare_Compare" "../../lib/isabelle/mpz_Z" "../../lib/isabelle/mpz_Zutil"
begin
theorem wmpz_neg'vc:
  fixes mpz :: "mpz_memo"
  fixes u :: "mpz_ptr"
  fixes w :: "mpz_ptr"
  assumes fact0: "readers mpz u = (0 :: int)"
  assumes fact1: "readers mpz w = (0 :: int)"
  assumes fact2: "(1 :: int) \<le> alloc mpz w"
  assumes fact3: "(1 :: int) \<le> alloc mpz u"
  shows "-(2 :: int) < readers mpz u"
  and "\<forall>(usize :: 32 word). sint usize = sgn mpz u * abs_size mpz u \<longrightarrow> int'32_in_bounds (-sint usize) \<and> (\<forall>(wsize :: 32 word). sint wsize = -sint usize \<longrightarrow> (mpz_eq u w \<longleftrightarrow> u = w) \<longrightarrow> (if \<not>mpz_eq u w then -(2147483648 :: int) < sint usize \<and> (\<forall>(size :: 32 word). sint size = abs (sint usize) \<longrightarrow> (readers mpz w = (0 :: int) \<and> (1 :: int) \<le> alloc mpz w) \<and> (\<forall>(mpz1 :: mpz_memo). sgn mpz1 = sgn mpz \<longrightarrow> (\<forall>(wp :: 64 word ptr). (\<forall>(y :: mpz_ptr). \<not>y = w \<longrightarrow> mpz_unchanged y mpz1 mpz) \<and> readers mpz1 w = -(1 :: int) \<and> abs_value_of mpz1 w = value wp (abs_size mpz1 w) \<and> zones mpz1 w = zone1 wp \<and> offset wp = (0 :: int) \<and> plength wp = alloc mpz1 w \<and> c_C.min wp = (0 :: int) \<and> c_C.max wp = plength wp \<and> writable wp = True \<and> abs_size mpz1 w = abs_size mpz w \<and> value wp (abs_size mpz w) = abs_value_of mpz w \<and> (if alloc mpz w < sint size then alloc mpz1 w = sint size else alloc mpz1 w = alloc mpz w) \<longrightarrow> (0 :: int) \<le> readers mpz1 u \<and> (\<forall>(mpz2 :: mpz_memo). abs_value_of mpz2 = abs_value_of mpz1 \<and> alloc mpz2 = alloc mpz1 \<and> abs_size mpz2 = abs_size mpz1 \<and> sgn mpz2 = sgn mpz1 \<and> zones mpz2 = zones mpz1 \<longrightarrow> (\<forall>(up :: 64 word ptr). readers mpz2 u = readers mpz1 u + (1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>u = y \<longrightarrow> readers mpz2 y = readers mpz1 y) \<and> value up (abs_size mpz2 u) = abs_value_of mpz2 u \<and> plength up = alloc mpz2 u \<and> offset up = (0 :: int) \<and> c_C.min up = (0 :: int) \<and> c_C.max up = plength up \<and> zone1 up = zones mpz2 u \<longrightarrow> (valid up (sint size) \<and> valid wp (sint size) \<and> writable wp = True) \<and> (\<forall>(up1 :: 64 word ptr) (wp1 :: 64 word ptr). offset up1 = offset up \<and> writable up1 = writable up \<and> zone1 up1 = zone1 up \<longrightarrow> offset wp1 = offset wp \<and> writable wp1 = writable wp \<and> zone1 wp1 = zone1 wp \<longrightarrow> map_eq_sub_shift (pelts wp1) (pelts up) (offset wp1) (offset up) (sint size) \<and> (\<forall>(j :: int). j < offset wp1 \<or> offset wp1 + sint size \<le> j \<longrightarrow> pelts wp1 j = pelts wp j) \<and> (\<forall>(j :: int). pelts up1 j = pelts up j) \<and> (c_C.min up1 = c_C.min up \<and> c_C.max up1 = c_C.max up \<and> plength up1 = plength up) \<and> c_C.min wp1 = c_C.min wp \<and> c_C.max wp1 = c_C.max wp \<and> plength wp1 = plength wp \<longrightarrow> (zones mpz2 u = zone1 up1 \<and> (1 :: int) \<le> readers mpz2 u \<and> c_C.min up1 = (0 :: int) \<and> c_C.max up1 = plength up1) \<and> (\<forall>(mpz3 :: mpz_memo). abs_value_of mpz3 = abs_value_of mpz2 \<and> alloc mpz3 = alloc mpz2 \<and> abs_size mpz3 = abs_size mpz2 \<and> sgn mpz3 = sgn mpz2 \<and> zones mpz3 = zones mpz2 \<longrightarrow> readers mpz3 u = readers mpz2 u - (1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>y = u \<longrightarrow> readers mpz3 y = readers mpz2 y) \<longrightarrow> (zones mpz3 w = zone1 wp1 \<and> readers mpz3 w = -(1 :: int) \<and> offset wp1 = (0 :: int) \<and> c_C.min wp1 = (0 :: int) \<and> c_C.max wp1 = plength wp1 \<and> abs (sint wsize) \<le> plength wp1 \<and> plength wp1 = alloc mpz3 w \<and> (\<not>sint wsize = (0 :: int) \<longrightarrow> ((18446744073709551615 :: int) + (1 :: int)) ^\<^sub>i (abs (sint wsize) - (1 :: int)) \<le> value wp1 (abs (sint wsize)))) \<and> (\<forall>(mpz4 :: mpz_memo). alloc mpz4 = alloc mpz3 \<and> readers mpz4 = readers mpz3 \<and> zones mpz4 = zones mpz3 \<longrightarrow> (\<forall>(y :: mpz_ptr). \<not>y = w \<longrightarrow> mpz_unchanged y mpz4 mpz3) \<and> (sgn mpz4 w = (1 :: int) \<longleftrightarrow> (0 :: int) \<le> sint wsize) \<and> (sgn mpz4 w = -(1 :: int) \<longleftrightarrow> sint wsize < (0 :: int)) \<and> abs_size mpz4 w = abs (sint wsize) \<and> abs_value_of mpz4 w = value wp1 (abs (sint wsize)) \<longrightarrow> (zones mpz4 w = zone1 wp1 \<and> readers mpz4 w = -(1 :: int) \<and> c_C.min wp1 = (0 :: int) \<and> c_C.max wp1 = plength wp1 \<and> abs_value_of mpz4 w = value wp1 (abs_size mpz4 w)) \<and> (\<forall>(mpz5 :: mpz_memo). abs_value_of mpz5 = abs_value_of mpz4 \<and> alloc mpz5 = alloc mpz4 \<and> abs_size mpz5 = abs_size mpz4 \<and> sgn mpz5 = sgn mpz4 \<and> zones mpz5 = zones mpz4 \<longrightarrow> readers mpz5 w = (0 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>y = w \<longrightarrow> readers mpz5 y = readers mpz4 y) \<longrightarrow> (readers mpz5 u = (0 :: int) \<and> readers mpz5 w = (0 :: int)) \<and> value_of w mpz5 = -value_of u mpz \<and> (\<forall>(x :: mpz_ptr). \<not>x = w \<longrightarrow> mpz_unchanged x mpz5 mpz)))))))))) else readers mpz w = (0 :: int) \<and> (\<forall>(mpz1 :: mpz_memo). abs_value_of mpz1 = abs_value_of mpz \<and> alloc mpz1 = alloc mpz \<and> abs_size mpz1 = abs_size mpz \<and> sgn mpz1 = sgn mpz \<and> zones mpz1 = zones mpz \<longrightarrow> (\<forall>(wp :: 64 word ptr). readers mpz1 w = -(1 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>w = y \<longrightarrow> readers mpz1 y = readers mpz y) \<and> value wp (abs_size mpz1 w) = abs_value_of mpz1 w \<and> plength wp = alloc mpz1 w \<and> offset wp = (0 :: int) \<and> c_C.min wp = (0 :: int) \<and> c_C.max wp = plength wp \<and> writable wp = True \<and> zone1 wp = zones mpz1 w \<longrightarrow> (zones mpz1 w = zone1 wp \<and> readers mpz1 w = -(1 :: int) \<and> offset wp = (0 :: int) \<and> c_C.min wp = (0 :: int) \<and> c_C.max wp = plength wp \<and> abs (sint wsize) \<le> plength wp \<and> plength wp = alloc mpz1 w \<and> (\<not>sint wsize = (0 :: int) \<longrightarrow> ((18446744073709551615 :: int) + (1 :: int)) ^\<^sub>i (abs (sint wsize) - (1 :: int)) \<le> value wp (abs (sint wsize)))) \<and> (\<forall>(mpz2 :: mpz_memo). alloc mpz2 = alloc mpz1 \<and> readers mpz2 = readers mpz1 \<and> zones mpz2 = zones mpz1 \<longrightarrow> (\<forall>(y :: mpz_ptr). \<not>y = w \<longrightarrow> mpz_unchanged y mpz2 mpz1) \<and> (sgn mpz2 w = (1 :: int) \<longleftrightarrow> (0 :: int) \<le> sint wsize) \<and> (sgn mpz2 w = -(1 :: int) \<longleftrightarrow> sint wsize < (0 :: int)) \<and> abs_size mpz2 w = abs (sint wsize) \<and> abs_value_of mpz2 w = value wp (abs (sint wsize)) \<longrightarrow> (zones mpz2 w = zone1 wp \<and> readers mpz2 w = -(1 :: int) \<and> c_C.min wp = (0 :: int) \<and> c_C.max wp = plength wp \<and> abs_value_of mpz2 w = value wp (abs_size mpz2 w)) \<and> (\<forall>(mpz3 :: mpz_memo). abs_value_of mpz3 = abs_value_of mpz2 \<and> alloc mpz3 = alloc mpz2 \<and> abs_size mpz3 = abs_size mpz2 \<and> sgn mpz3 = sgn mpz2 \<and> zones mpz3 = zones mpz2 \<longrightarrow> readers mpz3 w = (0 :: int) \<and> (\<forall>(y :: mpz_ptr). \<not>y = w \<longrightarrow> readers mpz3 y = readers mpz2 y) \<longrightarrow> (readers mpz3 u = (0 :: int) \<and> readers mpz3 w = (0 :: int)) \<and> value_of w mpz3 = -value_of u mpz \<and> (\<forall>(x :: mpz_ptr). \<not>x = w \<longrightarrow> mpz_unchanged x mpz3 mpz)))))))"
  sorry
end
