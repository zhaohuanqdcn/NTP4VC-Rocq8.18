theory flag2_Flag_dutch_flagqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref"
begin
datatype  color = Blue | White | Red
definition monochrome :: "(int \<Rightarrow> color) \<Rightarrow> int \<Rightarrow> int \<Rightarrow> color \<Rightarrow> _"
  where "monochrome a i j c \<longleftrightarrow> (\<forall>(k :: int). i \<le> k \<and> k < j \<longrightarrow> a k = c)" for a i j c
consts nb_occ :: "(int \<Rightarrow> color) \<Rightarrow> int \<Rightarrow> int \<Rightarrow> color \<Rightarrow> int"
axiomatization where nb_occ'def:   "if j \<le> i then nb_occ a i j c = (0 :: int) else if a (j - (1 :: int)) = c then nb_occ a i j c = (1 :: int) + nb_occ a i (j - (1 :: int)) c else nb_occ a i j c = nb_occ a i (j - (1 :: int)) c"
  for j :: "int"
  and i :: "int"
  and a :: "int \<Rightarrow> color"
  and c :: "color"
theorem dutch_flag'vc:
  fixes a :: "color list"
  shows "let o1 :: int = int (length a) in (((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> o1 \<and> o1 \<le> int (length a)) \<and> monochrome (nth a o nat) (0 :: int) (0 :: int) Blue \<and> monochrome (nth a o nat) (0 :: int) (0 :: int) White \<and> monochrome (nth a o nat) o1 (int (length a)) Red) \<and> (\<forall>(r :: int) (i :: int) (b :: int) (a1 :: color list). length a1 = length a \<longrightarrow> ((0 :: int) \<le> b \<and> b \<le> i \<and> i \<le> r \<and> r \<le> int (length a1)) \<and> monochrome (nth a1 o nat) (0 :: int) b Blue \<and> monochrome (nth a1 o nat) b i White \<and> monochrome (nth a1 o nat) r (int (length a1)) Red \<and> (\<forall>(c :: color). nb_occ (nth a1 o nat) (0 :: int) (int (length a1)) c = nb_occ (nth a o nat) (0 :: int) (int (length a1)) c) \<longrightarrow> (if i < r then ((0 :: int) \<le> i \<and> i < int (length a1)) \<and> (case a1 ! nat i of Blue \<Rightarrow> (((0 :: int) \<le> b \<and> b < int (length a1)) \<and> (0 :: int) \<le> i \<and> i < int (length a1)) \<and> (\<forall>(a2 :: color list). length a2 = length a1 \<longrightarrow> a2 ! nat b = a1 ! nat i \<and> a2 ! nat i = a1 ! nat b \<and> (\<forall>(k :: int). \<not>k = b \<and> \<not>k = i \<longrightarrow> a2 ! nat k = a1 ! nat k) \<and> (\<forall>(k1 :: int) (k2 :: int) (c :: color). (k1 \<le> b \<and> b < k2) \<and> k1 \<le> i \<and> i < k2 \<longrightarrow> nb_occ (nth a2 o nat) k1 k2 c = nb_occ (nth a1 o nat) k1 k2 c) \<longrightarrow> ((0 :: int) \<le> r - i \<and> r - (i + (1 :: int)) < r - i) \<and> ((0 :: int) \<le> b + (1 :: int) \<and> b + (1 :: int) \<le> i + (1 :: int) \<and> i + (1 :: int) \<le> r \<and> r \<le> int (length a2)) \<and> monochrome (nth a2 o nat) (0 :: int) (b + (1 :: int)) Blue \<and> monochrome (nth a2 o nat) (b + (1 :: int)) (i + (1 :: int)) White \<and> monochrome (nth a2 o nat) r (int (length a2)) Red \<and> (\<forall>(c :: color). nb_occ (nth a2 o nat) (0 :: int) (int (length a2)) c = nb_occ (nth a o nat) (0 :: int) (int (length a2)) c)) | White \<Rightarrow> ((0 :: int) \<le> r - i \<and> r - (i + (1 :: int)) < r - i) \<and> ((0 :: int) \<le> b \<and> b \<le> i + (1 :: int) \<and> i + (1 :: int) \<le> r \<and> r \<le> int (length a1)) \<and> monochrome (nth a1 o nat) (0 :: int) b Blue \<and> monochrome (nth a1 o nat) b (i + (1 :: int)) White \<and> monochrome (nth a1 o nat) r (int (length a1)) Red \<and> (\<forall>(c :: color). nb_occ (nth a1 o nat) (0 :: int) (int (length a1)) c = nb_occ (nth a o nat) (0 :: int) (int (length a1)) c) | Red \<Rightarrow> (((0 :: int) \<le> r - (1 :: int) \<and> r - (1 :: int) < int (length a1)) \<and> (0 :: int) \<le> i \<and> i < int (length a1)) \<and> (\<forall>(a2 :: color list). length a2 = length a1 \<longrightarrow> a2 ! nat (r - (1 :: int)) = a1 ! nat i \<and> a2 ! nat i = a1 ! nat (r - (1 :: int)) \<and> (\<forall>(k :: int). \<not>k = r - (1 :: int) \<and> \<not>k = i \<longrightarrow> a2 ! nat k = a1 ! nat k) \<and> (\<forall>(k1 :: int) (k2 :: int) (c :: color). (k1 \<le> r - (1 :: int) \<and> r - (1 :: int) < k2) \<and> k1 \<le> i \<and> i < k2 \<longrightarrow> nb_occ (nth a2 o nat) k1 k2 c = nb_occ (nth a1 o nat) k1 k2 c) \<longrightarrow> ((0 :: int) \<le> r - i \<and> r - (1 :: int) - i < r - i) \<and> ((0 :: int) \<le> b \<and> b \<le> i \<and> i \<le> r - (1 :: int) \<and> r - (1 :: int) \<le> int (length a2)) \<and> monochrome (nth a2 o nat) (0 :: int) b Blue \<and> monochrome (nth a2 o nat) b i White \<and> monochrome (nth a2 o nat) (r - (1 :: int)) (int (length a2)) Red \<and> (\<forall>(c :: color). nb_occ (nth a2 o nat) (0 :: int) (int (length a2)) c = nb_occ (nth a o nat) (0 :: int) (int (length a2)) c))) else (\<exists>(b1 :: int) (r1 :: int). monochrome (nth a1 o nat) (0 :: int) b1 Blue \<and> monochrome (nth a1 o nat) b1 r1 White \<and> monochrome (nth a1 o nat) r1 (int (length a1)) Red) \<and> (\<forall>(c :: color). nb_occ (nth a1 o nat) (0 :: int) (int (length a1)) c = nb_occ (nth a o nat) (0 :: int) (int (length a1)) c)))"
  sorry
end
