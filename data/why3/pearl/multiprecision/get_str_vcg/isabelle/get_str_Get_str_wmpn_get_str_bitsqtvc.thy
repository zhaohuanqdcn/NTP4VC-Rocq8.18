theory get_str_Get_str_wmpn_get_str_bitsqtvc
  imports "NTP4Verif.NTP4Verif" "Why3STD.Ref_Ref" "Why3STD.map_Const" "Why3STD.map_MapEq" "mach.int_Unsigned" "mach.c_C" "mach.c_UChar" "../../lib/isabelle/types_Config" "../../lib/isabelle/types_Types" "../../lib/isabelle/types_Int32Eq" "../../lib/isabelle/types_UInt64Eq" "../../lib/isabelle/lemmas_Lemmas" "../../lib/isabelle/powm_Powm" "../../lib/isabelle/compare_Compare" "../../lib/isabelle/valuation_Valuation" "../../lib/isabelle/util_Util" "../../lib/isabelle/ptralias_Alias" "../../lib/isabelle/util_UtilOld" "../../lib/isabelle/add_Add" "../../lib/isabelle/add_AddOld" "../../lib/isabelle/sub_SubOld" "../../lib/isabelle/mul_Mul" "../../lib/isabelle/mul_Mul_basecase" "../../lib/isabelle/logical_LogicalUtil" "../../lib/isabelle/logical_Logical" "../../lib/isabelle/logical_LogicalOld" "../../lib/isabelle/div_Div" "../../lib/isabelle/toom_Toom" "../../lib/isabelle/add_1_Add_1" "../../lib/isabelle/sub_1_Sub_1" "../../lib/isabelle/stringlemmas_String_lemmas" "../../lib/isabelle/base_info_BaseInfo"
begin
theorem wmpn_get_str_bits'vc:
  fixes un :: "32 word"
  fixes up :: "64 word ptr"
  fixes bits :: "32 word"
  fixes sp :: "8 word ptr"
  fixes ub :: "32 word"
  assumes fact0: "(1 :: int) \<le> sint un"
  assumes fact1: "valid up (sint un)"
  assumes fact2: "(1 :: int) \<le> uint bits"
  assumes fact3: "uint bits \<le> (8 :: int)"
  assumes fact4: "valid sp ((sint ub + uint bits - (1 :: int)) ediv uint bits)"
  assumes fact5: "(0 :: int) \<le> sint ub"
  assumes fact6: "value up (sint un) < (2 :: int) ^\<^sub>i sint ub"
  assumes fact7: "(0 :: int) < uint (pelts up (offset up + sint un - (1 :: int)))"
  assumes fact8: "(64 :: int) * sint un + (7 :: int) \<le> (2147483647 :: int)"
  assumes fact9: "writable sp = True"
  shows "int'32_in_bounds (sint un - (1 :: int))"
  and "\<forall>(o1 :: 32 word). sint o1 = sint un - (1 :: int) \<longrightarrow> (c_C.min up \<le> offset up + sint o1 \<and> offset up + sint o1 < c_C.max up) \<and> (let um :: 64 word = pelts up (offset up + sint o1) in (0 :: int) < uint um \<and> (\<forall>(sb :: 64 word). ((1 :: int) \<le> uint sb \<and> uint sb \<le> (64 :: int)) \<and> (2 :: int) ^\<^sub>i (uint sb - (1 :: int)) \<le> uint um \<and> uint um < (2 :: int) ^\<^sub>i uint sb \<longrightarrow> uint bits \<le> (2147483647 :: int) \<and> (\<forall>(o2 :: 32 word). sint o2 = uint bits \<longrightarrow> uint sb \<le> (2147483647 :: int) \<and> (\<forall>(o3 :: 32 word). sint o3 = uint sb \<longrightarrow> int'32_in_bounds (sint un - (1 :: int)) \<and> (\<forall>(o4 :: 32 word). sint o4 = sint un - (1 :: int) \<longrightarrow> int'32_in_bounds ((64 :: int) * sint o4) \<and> (\<forall>(o5 :: 32 word). sint o5 = (64 :: int) * sint o4 \<longrightarrow> int'32_in_bounds (sint o5 + sint o3) \<and> (\<forall>(o6 :: 32 word). sint o6 = sint o5 + sint o3 \<longrightarrow> int'32_in_bounds (sint o6 + sint o2) \<and> (\<forall>(o7 :: 32 word). sint o7 = sint o6 + sint o2 \<longrightarrow> int'32_in_bounds (sint o7 - (1 :: int)) \<and> (\<forall>(e :: 32 word). sint e = sint o7 - (1 :: int) \<longrightarrow> uint bits \<le> (2147483647 :: int) \<and> (\<forall>(o8 :: 32 word). sint o8 = uint bits \<longrightarrow> (\<not>sint o8 = (0 :: int) \<and> int'32_in_bounds (sint e cdiv sint o8)) \<and> (\<forall>(sn :: 32 word). sint sn = sint e cdiv sint o8 \<longrightarrow> (\<forall>(o9 :: 64 word). uint o9 = uint bits \<longrightarrow> (((0 :: int) \<le> uint o9 \<and> uint o9 < (64 :: int)) \<and> (2 :: int) ^\<^sub>i uint o9 * uint (1 :: 64 word) \<le> (18446744073709551615 :: int)) \<and> (\<forall>(b :: 64 word). uint b = (2 :: int) ^\<^sub>i uint o9 * uint (1 :: 64 word) \<longrightarrow> (((0 :: int) \<le> (0 :: int) \<and> (0 :: int) \<le> sint un) \<and> ((0 :: int) \<le> sint sn \<and> sint sn \<le> sint sn) \<and> (sint sn - sint sn) * uint bits = (0 :: int) \<and> ((0 :: int) < sint sn \<longrightarrow> (0 :: int) = (64 :: int) * (0 :: int) + (0 :: int)) \<and> ((0 :: int) \<le> (0 :: int) \<and> (0 :: int) < (64 :: int) \<or> (0 :: 32 word) = un) \<and> in_base (uint b) (pelts sp) (offset sp + sint sn) (offset sp + sint sn) \<and> (svalue_sub (uint b) (pelts sp) (offset sp + sint sn) (offset sp + sint sn) = valueb up (0 :: int) \<and> (0 :: int) \<le> (64 :: int) * sint un \<or> sint sn = (0 :: int) \<and> svalue (uint b) sp (sint sn) = value up (sint un))) \<and> (\<forall>(shift :: 64 word) (j :: 32 word) (i :: 32 word) (sp1 :: 8 word ptr). length (data sp1) = length (data sp) \<and> offset sp1 = offset sp \<and> c_C.min sp1 = c_C.min sp \<and> c_C.max sp1 = c_C.max sp \<and> writable sp1 = writable sp \<and> zone1 sp1 = zone1 sp \<longrightarrow> ((0 :: int) \<le> sint i \<and> sint i \<le> sint un) \<and> ((0 :: int) \<le> sint j \<and> sint j \<le> sint sn) \<and> ((0 :: int) < sint j \<longrightarrow> (sint sn - sint j) * uint bits = (64 :: int) * sint i + uint shift) \<and> ((0 :: int) \<le> uint shift \<and> uint shift < (64 :: int) \<or> i = un) \<and> in_base (uint b) (pelts sp1) (offset sp1 + sint j) (offset sp1 + sint sn) \<and> (svalue_sub (uint b) (pelts sp1) (offset sp1 + sint j) (offset sp1 + sint sn) = valueb up ((sint sn - sint j) * uint bits) \<and> (sint sn - sint j) * uint bits \<le> (64 :: int) * sint un \<or> sint j = (0 :: int) \<and> svalue (uint b) sp1 (sint sn) = value up (sint un)) \<and> (\<forall>(k :: int). k < offset sp1 \<or> offset sp1 + sint sn \<le> k \<longrightarrow> pelts sp1 k = pelts sp k) \<longrightarrow> (if (0 :: int) < sint j then int'32_in_bounds (sint j - (1 :: int)) \<and> (\<forall>(o10 :: 32 word). sint o10 = sint j - (1 :: int) \<longrightarrow> (c_C.min up \<le> offset up + sint i \<and> offset up + sint i < c_C.max up) \<and> ((0 :: int) \<le> uint shift \<and> uint shift < (64 :: int)) \<and> (\<forall>(o11 :: 64 word). uint o11 = uint (pelts up (offset up + sint i)) ediv (2 :: int) ^\<^sub>i uint shift \<longrightarrow> \<not>(2 :: int) ^\<^sub>i uint shift = (0 :: int) \<and> (\<forall>(o12 :: 64 word). uint o12 = uint bits \<longrightarrow> uint'64_in_bounds (uint shift + uint o12) \<and> (\<forall>(o13 :: 64 word). uint o13 = uint shift + uint o12 \<longrightarrow> (if (64 :: int) \<le> uint o13 then int'32_in_bounds (sint i + (1 :: int)) \<and> (\<forall>(o14 :: 32 word). sint o14 = sint i + (1 :: int) \<longrightarrow> (if sint o14 < sint un then uint'64_in_bounds (uint o13 - (64 :: int)) \<and> (\<forall>(o15 :: 64 word). uint o15 = uint o13 - (64 :: int) \<longrightarrow> (c_C.min up \<le> offset up + sint o14 \<and> offset up + sint o14 < c_C.max up) \<and> (\<forall>(o16 :: 64 word). uint o16 = uint bits \<longrightarrow> uint'64_in_bounds (uint o16 - uint o15) \<and> (\<forall>(o17 :: 64 word). uint o17 = uint o16 - uint o15 \<longrightarrow> ((0 :: int) \<le> uint o17 \<and> uint o17 < (64 :: int)) \<and> (\<forall>(high :: 64 word). uint high = uint (pelts up (offset up + sint o14)) * (2 :: int) ^\<^sub>i uint o17 emod ((18446744073709551615 :: int) + (1 :: int)) \<longrightarrow> uint'64_in_bounds (uint o11 + uint high) \<and> (\<forall>(o18 :: 64 word). uint o18 = uint o11 + uint high \<longrightarrow> (\<not>uint b = (0 :: int) \<and> uint'64_in_bounds (uint o18 cmod uint b)) \<and> (\<forall>(sj :: 64 word). uint sj = uint o18 cmod uint b \<longrightarrow> ((0 :: int) \<le> uint sj \<and> uint sj \<le> (255 :: int)) \<and> (\<forall>(o19 :: 8 word). uint o19 = uint sj \<longrightarrow> ((c_C.min sp1 \<le> offset sp1 + sint o10 \<and> offset sp1 + sint o10 < c_C.max sp1) \<and> writable sp1 = True) \<and> (\<forall>(sp2 :: 8 word ptr). length (data sp2) = length (data sp1) \<and> offset sp2 = offset sp1 \<and> c_C.min sp2 = c_C.min sp1 \<and> c_C.max sp2 = c_C.max sp1 \<and> writable sp2 = writable sp1 \<and> zone1 sp2 = zone1 sp1 \<longrightarrow> pelts sp2 = (pelts sp1)(offset sp2 + sint o10 := o19) \<and> pelts sp2 (offset sp2 + sint o10) = o19 \<longrightarrow> sint o10 < sint j \<and> ((0 :: int) \<le> sint o14 \<and> sint o14 \<le> sint un) \<and> ((0 :: int) \<le> sint o10 \<and> sint o10 \<le> sint sn) \<and> (sint sn - sint o10) * uint bits = (sint sn - sint j) * uint bits + uint bits \<and> ((0 :: int) < sint o10 \<longrightarrow> (sint sn - sint j) * uint bits + uint bits = (64 :: int) * sint o14 + uint o15) \<and> ((0 :: int) \<le> uint o15 \<and> uint o15 < (64 :: int) \<or> o14 = un) \<and> in_base (uint b) (pelts sp2) (offset sp2 + sint o10) (offset sp2 + sint sn) \<and> (svalue_sub (uint b) (pelts sp2) (offset sp2 + sint o10) (offset sp2 + sint sn) = valueb up ((sint sn - sint j) * uint bits + uint bits) \<and> (sint sn - sint j) * uint bits + uint bits \<le> (64 :: int) * sint un \<or> sint o10 = (0 :: int) \<and> svalue (uint b) sp2 (sint sn) = value up (sint un)) \<and> (\<forall>(k :: int). k < offset sp2 \<or> offset sp2 + sint sn \<le> k \<longrightarrow> pelts sp2 k = pelts sp k))))))))) else (\<not>uint b = (0 :: int) \<and> uint'64_in_bounds (uint o11 cmod uint b)) \<and> (\<forall>(sj :: 64 word). uint sj = uint o11 cmod uint b \<longrightarrow> ((0 :: int) \<le> uint sj \<and> uint sj \<le> (255 :: int)) \<and> (\<forall>(o15 :: 8 word). uint o15 = uint sj \<longrightarrow> ((c_C.min sp1 \<le> offset sp1 + sint o10 \<and> offset sp1 + sint o10 < c_C.max sp1) \<and> writable sp1 = True) \<and> (\<forall>(sp2 :: 8 word ptr). length (data sp2) = length (data sp1) \<and> offset sp2 = offset sp1 \<and> c_C.min sp2 = c_C.min sp1 \<and> c_C.max sp2 = c_C.max sp1 \<and> writable sp2 = writable sp1 \<and> zone1 sp2 = zone1 sp1 \<longrightarrow> pelts sp2 = (pelts sp1)(offset sp2 + sint o10 := o15) \<and> pelts sp2 (offset sp2 + sint o10) = o15 \<longrightarrow> sint o10 < sint j \<and> ((0 :: int) \<le> sint o14 \<and> sint o14 \<le> sint un) \<and> ((0 :: int) \<le> sint o10 \<and> sint o10 \<le> sint sn) \<and> (sint sn - sint o10) * uint bits = (sint sn - sint j) * uint bits + uint bits \<and> ((0 :: int) < sint o10 \<longrightarrow> (sint sn - sint j) * uint bits + uint bits = (64 :: int) * sint o14 + uint o13) \<and> ((0 :: int) \<le> uint o13 \<and> uint o13 < (64 :: int) \<or> o14 = un) \<and> in_base (uint b) (pelts sp2) (offset sp2 + sint o10) (offset sp2 + sint sn) \<and> (svalue_sub (uint b) (pelts sp2) (offset sp2 + sint o10) (offset sp2 + sint sn) = valueb up ((sint sn - sint j) * uint bits + uint bits) \<and> (sint sn - sint j) * uint bits + uint bits \<le> (64 :: int) * sint un \<or> sint o10 = (0 :: int) \<and> svalue (uint b) sp2 (sint sn) = value up (sint un)) \<and> (\<forall>(k :: int). k < offset sp2 \<or> offset sp2 + sint sn \<le> k \<longrightarrow> pelts sp2 k = pelts sp k)))))) else (\<not>uint b = (0 :: int) \<and> uint'64_in_bounds (uint o11 cmod uint b)) \<and> (\<forall>(sj :: 64 word). uint sj = uint o11 cmod uint b \<longrightarrow> ((0 :: int) \<le> uint sj \<and> uint sj \<le> (255 :: int)) \<and> (\<forall>(o14 :: 8 word). uint o14 = uint sj \<longrightarrow> ((c_C.min sp1 \<le> offset sp1 + sint o10 \<and> offset sp1 + sint o10 < c_C.max sp1) \<and> writable sp1 = True) \<and> (\<forall>(sp2 :: 8 word ptr). length (data sp2) = length (data sp1) \<and> offset sp2 = offset sp1 \<and> c_C.min sp2 = c_C.min sp1 \<and> c_C.max sp2 = c_C.max sp1 \<and> writable sp2 = writable sp1 \<and> zone1 sp2 = zone1 sp1 \<longrightarrow> pelts sp2 = (pelts sp1)(offset sp2 + sint o10 := o14) \<and> pelts sp2 (offset sp2 + sint o10) = o14 \<longrightarrow> sint o10 < sint j \<and> ((0 :: int) \<le> sint i \<and> sint i \<le> sint un) \<and> ((0 :: int) \<le> sint o10 \<and> sint o10 \<le> sint sn) \<and> (sint sn - sint o10) * uint bits = (sint sn - sint j) * uint bits + uint bits \<and> ((0 :: int) < sint o10 \<longrightarrow> (sint sn - sint j) * uint bits + uint bits = (64 :: int) * sint i + uint o13) \<and> ((0 :: int) \<le> uint o13 \<and> uint o13 < (64 :: int) \<or> i = un) \<and> in_base (uint b) (pelts sp2) (offset sp2 + sint o10) (offset sp2 + sint sn) \<and> (svalue_sub (uint b) (pelts sp2) (offset sp2 + sint o10) (offset sp2 + sint sn) = valueb up ((sint sn - sint j) * uint bits + uint bits) \<and> (sint sn - sint j) * uint bits + uint bits \<le> (64 :: int) * sint un \<or> sint o10 = (0 :: int) \<and> svalue (uint b) sp2 (sint sn) = value up (sint un)) \<and> (\<forall>(k :: int). k < offset sp2 \<or> offset sp2 + sint sn \<le> k \<longrightarrow> pelts sp2 k = pelts sp k))))))))) else (0 :: int) \<le> sint sn \<and> (\<forall>(result :: 32 word). uint result = sint sn \<longrightarrow> in_base ((2 :: int) ^\<^sub>i uint bits) (pelts sp1) (offset sp1) (offset sp1 + uint result) \<and> svalue ((2 :: int) ^\<^sub>i uint bits) sp1 (uint result) = value up (sint un) \<and> ((0 :: int) < uint result \<and> uint result \<le> (sint ub + uint bits - (1 :: int)) ediv uint bits) \<and> (0 :: int) < uint (pelts sp1 (offset sp1)) \<and> (\<forall>(j1 :: int). j1 < offset sp1 \<or> offset sp1 + (sint ub + uint bits - (1 :: int)) ediv uint bits \<le> j1 \<longrightarrow> pelts sp1 j1 = pelts sp j1)))))))))))))))))"
  sorry
end
